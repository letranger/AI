<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2024-07-18 Thu 12:26 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>資料預處理</title>
<meta name="author" content="Yung-Chin Yen" />
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
<link rel="stylesheet" type="text/css" href="../css/muse.css" />
<script>
  window.MathJax = {
    tex: {
      ams: {
        multlineWidth: '85%'
      },
      tags: 'ams',
      tagSide: 'right',
      tagIndent: '.8em'
    },
    chtml: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    svg: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    output: {
      font: 'mathjax-modern',
      displayOverflow: 'overflow'
    }
  };
</script>

<script
  id="MathJax-script"
  async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
</head>
<body>
<div id="content" class="content">
<h1 class="title">資料預處理</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#orgd5db21e">1. 資料預處理</a>
<ul>
<li><a href="#org02798c4">1.1. 讀檔</a></li>
<li><a href="#org660f653">1.2. 刪除遺漏值</a></li>
<li><a href="#org1c2dafd">1.3. 填補遺漏值</a></li>
<li><a href="#org3f4d0e2">1.4. [作業]資料預處理&#xa0;&#xa0;&#xa0;<span class="tag"><span class="TNFSH">TNFSH</span></span></a></li>
</ul>
</li>
<li><a href="#org1cc8537">2. 資料集分類特徵編碼</a>
<ul>
<li><a href="#org30f5a95">2.1. categorical feature</a></li>
<li><a href="#orgaf8f24d">2.2. ordinal feature</a></li>
<li><a href="#org95d48f8">2.3. nominal feature</a></li>
<li><a href="#org0c0b51c">2.4. One-Hot Encoding</a></li>
</ul>
</li>
<li><a href="#org8c2f78f">3. 特徵縮放(Feature scaling)</a>
<ul>
<li><a href="#orga4765ce">3.1. 常態化(Normalization)</a></li>
<li><a href="#org4a03bfc">3.2. 標準化(Standardization)</a></li>
</ul>
</li>
<li><a href="#orgd8a3524">4. 資料擴增</a>
<ul>
<li><a href="#org3df4ae2">4.1. 範例</a></li>
<li><a href="#org0d3d852">4.2. 其他擴增方法</a></li>
</ul>
</li>
<li><a href="#org0566b88">5. 資料集與資料分割</a>
<ul>
<li><a href="#orgf590d07">5.1. 常用資料集</a></li>
<li><a href="#org636831a">5.2. 資料分割</a></li>
</ul>
</li>
<li><a href="#org4dde276">6. 資料間的關係</a>
<ul>
<li><a href="#org3d5f0a3">6.1. 兩點間的距離</a></li>
<li><a href="#org1a0ed19">6.2. 兩個向量間的距離</a></li>
<li><a href="#orgfefe723">6.3. 其他應用</a></li>
<li><a href="#org63fa83f">6.4. 進階閱讀</a></li>
<li><a href="#org758f33d">6.5. [作業]能力相似度&#xa0;&#xa0;&#xa0;<span class="tag"><span class="TNFSH">TNFSH</span></span></a></li>
</ul>
</li>
</ul>
</div>
</div>
<a href="https://hits.sh/letranger.github.io/AI/20221023130936-資料預處理.html"><img alt="Hits" align="right" src="https://hits.sh/letranger.github.io/AI/20221023130936-資料預處理.html.svg"/></a>

<p>
進行數運模式運算之前，需要進行的數據預處理工作大致可分為以下幾點：<br />
</p>
<ol class="org-ol">
<li>數據遺漏值處理<br /></li>
<li>數據分類編碼<br /></li>
<li>數據訓練集與測試集之分割<br /></li>
<li>數據特徵選取<br /></li>
</ol>
<div id="outline-container-orgd5db21e" class="outline-2">
<h2 id="orgd5db21e"><span class="section-number-2">1.</span> 資料預處理</h2>
<div class="outline-text-2" id="text-1">
<p>
在收集到所需的資料後，常會遇到各種資料不全、缺失的情況，因此需要對資料進行整理，以便後續的分析。進行數運模式運算之前，需要進行的<a href="20221023130936-資料預處理.html#ID-82e219c3-6ca0-43b0-bb11-e3a8454f089d">資料預處理</a>工作大致可分為以下幾點：<br />
</p>
<ol class="org-ol">
<li>數據遺漏值處理<br /></li>
<li>數據分類編碼<br /></li>
<li>數據訓練集與測試集之分割<br /></li>
<li>數據特徵選取<br /></li>
</ol>

<p>
以下的程式碼都是簡單的pandas應用，如果你看不懂，表示你自已要惡補一下Pandas的課程，可以參看:<br />
</p>
<ul class="org-ul">
<li><a href="https://letranger.github.io/PythonCourse/Pandas.html">Pandas教學</a><br /></li>
<li><a href="https://leemeng.tw/practical-pandas-tutorial-for-aspiring-data-scientists.html">資料科學家的 pandas實戰手冊:掌握40個實用數據技巧</a><br /></li>
<li>其他的自己<a href="https://www.google.com/">Google</a><br /></li>
</ul>
</div>
<div id="outline-container-org02798c4" class="outline-3">
<h3 id="org02798c4"><span class="section-number-3">1.1.</span> 讀檔</h3>
<div class="outline-text-3" id="text-1-1">
<ul class="org-ul">
<li><a href="images/資料預處理/2024-07-16_12-07-12_CatDog.csv">按這裡下載測試檔案</a><br /></li>
</ul>
</div>
<div id="outline-container-org37dac74" class="outline-4">
<h4 id="org37dac74"><span class="section-number-4">1.1.1.</span> Colab</h4>
<div class="outline-text-4" id="text-1-1-1">
</div>
<div id="outline-container-org360a0c7" class="outline-5">
<h5 id="org360a0c7"><span class="section-number-5">1.1.1.1.</span> 檔案在/content裡</h5>
<div class="outline-text-5" id="text-1-1-1-1">
</div>
<ol class="org-ol">
<li><a id="org9cad4a4"></a>先把下載的檔案拉到<br />
<div class="outline-text-6" id="text-1-1-1-1-1">

<div id="org8d14ace" class="figure">
<p><img src="images/Colab編寫環境/2024-01-13_13-54-39_2024-01-13_13-54-06.png" alt="2024-01-13_13-54-39_2024-01-13_13-54-06.png" width="300" /><br />
</p>
<p><span class="figure-number">Figure 1: </span>將檔案上傳至Colab雲端硬碟</p>
</div>
</div>
</li>
<li><a id="orgfb5d6f3"></a>讀取檔案<br />
<div class="outline-text-6" id="text-1-1-1-1-2">
<div class="org-src-container">
<pre class="src src-python"><span class="linenr">1: </span><span style="color: #51afef;">import</span> pandas <span style="color: #51afef;">as</span> pd
<span class="linenr">2: </span>
<span class="linenr">3: </span><span style="color: #dcaeea;">origdf</span> = pd.read_csv(<span style="color: #98be65;">"/content/CatDog.csv"</span>)
<span class="linenr">4: </span>
</pre>
</div>
</div>
</li>
</ol>
</div>
<div id="outline-container-org9a603f8" class="outline-5">
<h5 id="org9a603f8"><span class="section-number-5">1.1.1.2.</span> 檔案在你的Google Drive</h5>
<div class="outline-text-5" id="text-1-1-1-2">
<p>
先連結Google Drive<br />
</p>
<div class="org-src-container">
<pre class="src src-python"><span class="linenr">1: </span><span style="color: #51afef;">import</span> pandas <span style="color: #51afef;">as</span> pd
<span class="linenr">2: </span><span style="color: #5B6268;"># </span><span style="color: #5B6268;">import Google Drive &#22871;&#20214;</span>
<span class="linenr">3: </span><span style="color: #51afef;">from</span> google.colab <span style="color: #51afef;">import</span> drive
<span class="linenr">4: </span><span style="color: #5B6268;"># </span><span style="color: #5B6268;">&#23559;&#33258;&#24049;&#30340;&#38642;&#31471;&#30828;&#30879;&#25499;&#36617;&#19978;&#21435;</span>
<span class="linenr">5: </span>drive.mount(<span style="color: #98be65;">'/content/gdrive'</span>)
<span class="linenr">6: </span><span style="color: #5B6268;"># </span><span style="color: #5B6268;">&#36879;&#36942; gdrive/My Drive/... &#20358;&#23384;&#21462;&#27284;&#26696;</span>
<span class="linenr">7: </span><span style="color: #dcaeea;">test</span> = pd.read_csv(<span style="color: #98be65;">'gdrive/My Drive/CatDog.csv'</span>)
<span class="linenr">8: </span>test
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-org660f653" class="outline-3">
<h3 id="org660f653"><span class="section-number-3">1.2.</span> 刪除遺漏值</h3>
<div class="outline-text-3" id="text-1-2">
<p>
現實世界中可能會因各種原因導致數據缺失或遺漏(如問卷被刻意留白)，這些部份通常會以「空白」、「NaN」或「NULL」來取代。<br />
</p>
</div>
<div id="outline-container-orgadcb9d5" class="outline-4">
<h4 id="orgadcb9d5"><span class="section-number-4">1.2.1.</span> 查看資料集內容</h4>
<div class="outline-text-4" id="text-1-2-1">
<div class="org-src-container">
<pre class="src src-python"><span class="linenr">1: </span><span style="color: #51afef;">import</span> os
<span class="linenr">2: </span>
<span class="linenr">3: </span><span style="color: #c678dd;">print</span>(os.environ[<span style="color: #98be65;">'VIRTUAL_ENV'</span>])
</pre>
</div>

<pre class="example">
/Users/letranger/.cache/pypoetry/virtualenvs/my-poetry-virtual-env-xUtoYcEX-py3.7
</pre>


<div class="org-src-container">
<pre class="src src-python"><span class="linenr"> 1: </span><span style="color: #dcaeea;">csv_data</span> =<span style="color: #98be65;">"""A,B,C,D,E</span>
<span class="linenr"> 2: </span><span style="color: #98be65;"> 1.0,,  2.0,  3.0, 4.0</span>
<span class="linenr"> 3: </span><span style="color: #98be65;"> 5.0,,  6.0,, 8.0</span>
<span class="linenr"> 4: </span><span style="color: #98be65;">10.0,, 11.0, 12.0, 5.0</span>
<span class="linenr"> 5: </span><span style="color: #98be65;">9.9,,8.0, 12.0"""</span>
<span class="linenr"> 6: </span>
<span class="linenr"> 7: </span><span style="color: #51afef;">import</span> sys
<span class="linenr"> 8: </span><span style="color: #51afef;">import</span> pandas <span style="color: #51afef;">as</span> pd
<span class="linenr"> 9: </span><span style="color: #5B6268;"># </span><span style="color: #5B6268;">python 2.7&#38656;&#36914;&#34892;unicode&#36681;&#30908;</span>
<span class="linenr">10: </span><span style="color: #51afef;">if</span> (sys.version_info &lt; (<span style="color: #da8548; font-weight: bold;">3</span>, <span style="color: #da8548; font-weight: bold;">0</span>)):
<span class="linenr">11: </span>    <span style="color: #dcaeea;">csv_data</span> = <span style="color: #c678dd;">unicode</span>(csv_data)
<span class="linenr">12: </span><span style="color: #5B6268;"># </span><span style="color: #5B6268;">&#35712;&#20837;&#31243;&#24335;&#27284;&#20013;&#30340;csv&#36039;&#26009;</span>
<span class="linenr">13: </span><span style="color: #51afef;">from</span> io <span style="color: #51afef;">import</span> StringIO
<span class="linenr">14: </span><span style="color: #dcaeea;">df</span> = pd.read_csv(StringIO(csv_data))
<span class="linenr">15: </span><span style="color: #c678dd;">print</span>(df)
</pre>
</div>

<pre class="example">
      A   B     C     D    E
0   1.0 NaN   2.0   3.0  4.0
1   5.0 NaN   6.0   NaN  8.0
2  10.0 NaN  11.0  12.0  5.0
3   9.9 NaN   8.0  12.0  NaN
</pre>


<p>
雖然pd.read_csv是用來讀取網路上或本機端的csv檔，此處為了省去大家讀取d檔案的工作，我們以直接以字串模擬一個檔案出來，所以在讀取時要以以下的方式來讀：<br />
</p>
<div class="org-src-container">
<pre class="src src-python"><span class="linenr">1: </span>pd.read_csv)StringIO(&#23383;&#20018;&#35722;&#25976;&#21517;&#31281;)
</pre>
</div>
</div>
</div>
<div id="outline-container-orgb0d25f4" class="outline-4">
<h4 id="orgb0d25f4"><span class="section-number-4">1.2.2.</span> 遺漏值的識別</h4>
<div class="outline-text-4" id="text-1-2-2">
<p>
現在可以大概統計一下遺漏值<br />
</p>
<div class="org-src-container">
<pre class="src src-python"><span class="linenr">1: </span><span style="color: #5B6268;"># </span><span style="color: #5B6268;">&#21015;&#20986;&#27599;&#34892;&#26377;&#30340;null&#20491;&#25976;</span>
<span class="linenr">2: </span><span style="color: #c678dd;">print</span>(df.isnull().<span style="color: #c678dd;">sum</span>())
</pre>
</div>

<pre class="example">
A    0
B    4
C    0
D    1
E    1
dtype: int64
</pre>
</div>
</div>
<div id="outline-container-org7abf9db" class="outline-4">
<h4 id="org7abf9db"><span class="section-number-4">1.2.3.</span> 刪除有遺漏值的記錄</h4>
<div class="outline-text-4" id="text-1-2-3">
<div class="org-src-container">
<pre class="src src-python"><span class="linenr"> 1: </span><span style="color: #5B6268;"># </span><span style="color: #5B6268;">&#21083;&#38500;&#26377;&#36986;&#22833;&#20540;&#30340;&#36039;&#26009;&#21015;</span>
<span class="linenr"> 2: </span><span style="color: #c678dd;">print</span>(<span style="color: #98be65;">'====&#21034;&#25481;&#26377;&#36986;&#22833;&#20540;&#30340;&#21015;:df.dropna(axis=1)===='</span>)
<span class="linenr"> 3: </span><span style="color: #dcaeea;">tmpDf</span> = df.dropna(axis=<span style="color: #da8548; font-weight: bold;">0</span>)
<span class="linenr"> 4: </span><span style="color: #c678dd;">print</span>(tmpDf) <span style="color: #5B6268;">#</span><span style="color: #5B6268;">&#20840;&#37096;&#26371;&#34987;&#21034;&#25481;</span>
<span class="linenr"> 5: </span><span style="color: #5B6268;"># </span><span style="color: #5B6268;">&#21083;&#38500;&#26377;&#36986;&#22833;&#20540;&#30340;&#36039;&#26009;&#34892;</span>
<span class="linenr"> 6: </span><span style="color: #c678dd;">print</span>(<span style="color: #98be65;">'====&#21034;&#25481;&#26377;&#36986;&#22833;&#20540;&#30340;&#27396;:df.dropna(axis=1)===='</span>)
<span class="linenr"> 7: </span><span style="color: #dcaeea;">tmpDf</span> = df.dropna(axis=<span style="color: #da8548; font-weight: bold;">1</span>)
<span class="linenr"> 8: </span><span style="color: #c678dd;">print</span>(tmpDf)
<span class="linenr"> 9: </span><span style="color: #5B6268;"># </span><span style="color: #5B6268;">&#21083;&#38500;&#25972;&#21015;&#28858;NaN&#32773;</span>
<span class="linenr">10: </span><span style="color: #c678dd;">print</span>(<span style="color: #98be65;">'====&#21083;&#38500;&#25972;&#27396;&#28858;NaN&#32773;:df.dropna(how=</span><span style="color: #a9a1e1;">\'</span><span style="color: #98be65;">all</span><span style="color: #a9a1e1;">\'</span><span style="color: #98be65;">)===='</span>)
<span class="linenr">11: </span><span style="color: #dcaeea;">tmpDf</span> = df.dropna(axis=<span style="color: #da8548; font-weight: bold;">1</span>, how=<span style="color: #98be65;">'all'</span>)
<span class="linenr">12: </span><span style="color: #c678dd;">print</span>(tmpDf)
<span class="linenr">13: </span><span style="color: #5B6268;"># </span><span style="color: #5B6268;">&#21034;&#38500;&#26377;&#20540;&#20491;&#25976;&#20302;&#26044;thresh&#30340;&#21015;</span>
<span class="linenr">14: </span><span style="color: #c678dd;">print</span>(<span style="color: #98be65;">'====&#21034;&#38500;&#26377;&#20540;&#20491;&#25976;&#20302;&#26044;thresh&#30340;&#21015;:df.dropna(thresh=4)===='</span>)
<span class="linenr">15: </span><span style="color: #dcaeea;">tmpDf</span> = df.dropna(thresh=<span style="color: #da8548; font-weight: bold;">4</span>)
<span class="linenr">16: </span><span style="color: #c678dd;">print</span>(tmpDf)
<span class="linenr">17: </span><span style="color: #5B6268;"># </span><span style="color: #5B6268;">&#21034;&#38500;&#29305;&#23450;&#34892;(&#22914;&#31532;C&#34892;)&#20013;&#26377;NaN&#20043;&#21015;</span>
<span class="linenr">18: </span><span style="color: #c678dd;">print</span>(<span style="color: #98be65;">'====&#21034;&#38500;&#29305;&#23450;&#34892;(&#22914;&#31532;C&#34892;)&#20013;&#26377;NaN&#20043;&#21015;:df.dropna(columns=[</span><span style="color: #a9a1e1;">\'</span><span style="color: #98be65;">C</span><span style="color: #a9a1e1;">\'</span><span style="color: #98be65;">])===='</span>)
<span class="linenr">19: </span><span style="color: #dcaeea;">tmpDf</span>=df.drop(columns=[<span style="color: #98be65;">'C'</span>])
<span class="linenr">20: </span><span style="color: #c678dd;">print</span>(tmpDf)
</pre>
</div>

<pre class="example" id="org04da8d0">
====刪掉有遺失值的列:df.dropna(axis=1)====
Empty DataFrame
Columns: [A, B, C, D, E]
Index: []
====刪掉有遺失值的欄:df.dropna(axis=1)====
      A     C
0   1.0   2.0
1   5.0   6.0
2  10.0  11.0
3   9.9   8.0
====剛除整欄為NaN者:df.dropna(how='all')====
      A     C     D    E
0   1.0   2.0   3.0  4.0
1   5.0   6.0   NaN  8.0
2  10.0  11.0  12.0  5.0
3   9.9   8.0  12.0  NaN
====刪除有值個數低於thresh的列:df.dropna(thresh=4)====
      A   B     C     D    E
0   1.0 NaN   2.0   3.0  4.0
2  10.0 NaN  11.0  12.0  5.0
====刪除特定行(如第C行)中有NaN之列:df.dropna(columns=['C'])====
      A   B     D    E
0   1.0 NaN   3.0  4.0
1   5.0 NaN   NaN  8.0
2  10.0 NaN  12.0  5.0
3   9.9 NaN  12.0  NaN
</pre>
<p>
雖然刪除包含遺漏值的數據似乎是個方便的方法，但終究可能會刪除過多的樣本，導致分析的結果並不可靠；或是因為刪除了特徵的時候，卻失去了重要的資訊。<br />
</p>
</div>
</div>
</div>
<div id="outline-container-org1c2dafd" class="outline-3">
<h3 id="org1c2dafd"><span class="section-number-3">1.3.</span> 填補遺漏值</h3>
<div class="outline-text-3" id="text-1-3">
</div>
<div id="outline-container-org214f1f9" class="outline-4">
<h4 id="org214f1f9"><span class="section-number-4">1.3.1.</span> 直接填零</h4>
<div class="outline-text-4" id="text-1-3-1">
<div class="org-src-container">
<pre class="src src-python"><span class="linenr"> 1: </span><span style="color: #dcaeea;">csv_data</span> =<span style="color: #98be65;">"""A,B,C,D,E</span>
<span class="linenr"> 2: </span><span style="color: #98be65;"> 1.0,7.7, 2.0,  3.0, 4.0</span>
<span class="linenr"> 3: </span><span style="color: #98be65;"> 5.0,,  6.0,, 8.0</span>
<span class="linenr"> 4: </span><span style="color: #98be65;">10.0,, 11.0, 12.0, 5.0</span>
<span class="linenr"> 5: </span><span style="color: #98be65;">9.9,8.8,8.0, 12.0"""</span>
<span class="linenr"> 6: </span>
<span class="linenr"> 7: </span><span style="color: #51afef;">import</span> sys
<span class="linenr"> 8: </span><span style="color: #51afef;">import</span> pandas <span style="color: #51afef;">as</span> pd
<span class="linenr"> 9: </span><span style="color: #5B6268;"># </span><span style="color: #5B6268;">python 2.7&#38656;&#36914;&#34892;unicode&#36681;&#30908;</span>
<span class="linenr">10: </span><span style="color: #51afef;">if</span> (sys.version_info &lt; (<span style="color: #da8548; font-weight: bold;">3</span>, <span style="color: #da8548; font-weight: bold;">0</span>)):
<span class="linenr">11: </span>    <span style="color: #dcaeea;">csv_data</span> = <span style="color: #c678dd;">unicode</span>(csv_data)
<span class="linenr">12: </span><span style="color: #5B6268;"># </span><span style="color: #5B6268;">&#35712;&#20837;&#31243;&#24335;&#27284;&#20013;&#30340;csv&#36039;&#26009;</span>
<span class="linenr">13: </span><span style="color: #51afef;">from</span> io <span style="color: #51afef;">import</span> StringIO
<span class="linenr">14: </span><span style="color: #dcaeea;">df</span> = pd.read_csv(StringIO(csv_data))
<span class="linenr">15: </span>
<span class="linenr">16: </span><span style="color: #dcaeea;">tmpDf</span> = df.fillna(<span style="color: #da8548; font-weight: bold;">0</span>)
<span class="linenr">17: </span><span style="color: #c678dd;">print</span>(tmpDf)
</pre>
</div>

<pre class="example">
      A    B     C     D    E
0   1.0  7.7   2.0   3.0  4.0
1   5.0  0.0   6.0   0.0  8.0
2  10.0  0.0  11.0  12.0  5.0
3   9.9  8.8   8.0  12.0  0.0
</pre>
</div>
</div>
<div id="outline-container-org9dce7b9" class="outline-4">
<h4 id="org9dce7b9"><span class="section-number-4">1.3.2.</span> 以平均值填補</h4>
<div class="outline-text-4" id="text-1-3-2">
</div>
<div id="outline-container-orga3d086c" class="outline-5">
<h5 id="orga3d086c"><span class="section-number-5">1.3.2.1.</span> Python手動填補</h5>
<div class="outline-text-5" id="text-1-3-2-1">
<div class="org-src-container">
<pre class="src src-python"><span class="linenr">1: </span><span style="color: #c678dd;">print</span>(df)
<span class="linenr">2: </span><span style="color: #dcaeea;">df</span>[<span style="color: #98be65;">'D'</span>] = df[<span style="color: #98be65;">'D'</span>].fillna(df[<span style="color: #98be65;">'D'</span>].mean())
<span class="linenr">3: </span><span style="color: #c678dd;">print</span>(df)
</pre>
</div>

<pre class="example" id="org6891c1f">
      A    B     C     D    E
0   1.0  7.7   2.0   3.0  4.0
1   5.0  NaN   6.0   NaN  8.0
2  10.0  NaN  11.0  12.0  5.0
3   9.9  8.8   8.0  12.0  NaN
      A    B     C     D    E
0   1.0  7.7   2.0   3.0  4.0
1   5.0  NaN   6.0   9.0  8.0
2  10.0  NaN  11.0  12.0  5.0
3   9.9  8.8   8.0  12.0  NaN
</pre>
</div>
</div>
<div id="outline-container-org59e0796" class="outline-5">
<h5 id="org59e0796"><span class="section-number-5">1.3.2.2.</span> 以scikit-learn的impute填補</h5>
<div class="outline-text-5" id="text-1-3-2-2">
<p>
最常見的「插補技術」之一為「平均插補」(mean imputation)，即，以整個特徵行的平均值來代替遺漏值。<br />
</p>
<div class="org-src-container">
<pre class="src src-python"><span class="linenr">1: </span><span style="color: #5B6268;"># </span><span style="color: #5B6268;">impute missing values via the column mean</span>
<span class="linenr">2: </span><span style="color: #51afef;">from</span> sklearn.impute <span style="color: #51afef;">import</span> SimpleImputer
<span class="linenr">3: </span><span style="color: #51afef;">import</span> numpy <span style="color: #51afef;">as</span> np
<span class="linenr">4: </span>
<span class="linenr">5: </span><span style="color: #dcaeea;">imr</span> = SimpleImputer(missing_values=np.nan, strategy=<span style="color: #98be65;">'mean'</span>)
<span class="linenr">6: </span><span style="color: #dcaeea;">imr</span> = imr.fit(df.values)
<span class="linenr">7: </span><span style="color: #dcaeea;">imputed_data</span> = imr.transform(df.values)
<span class="linenr">8: </span><span style="color: #c678dd;">print</span>(df)
<span class="linenr">9: </span><span style="color: #c678dd;">print</span>(imputed_data)
</pre>
</div>

<pre class="example">
      A    B     C     D    E
0   1.0  7.7   2.0   3.0  4.0
1   5.0  NaN   6.0   9.0  8.0
2  10.0  NaN  11.0  12.0  5.0
3   9.9  8.8   8.0  12.0  NaN
[[ 1.          7.7         2.          3.          4.        ]
 [ 5.          8.25        6.          9.          8.        ]
 [10.          8.25       11.         12.          5.        ]
 [ 9.9         8.8         8.         12.          5.66666667]]
</pre>


<p>
scikit-learn早期版本的填補類別為Imputer，屬於 transformer 類別，主要的工作是做「數據轉換」，這些 estimator 有兩種基本方法：fit 與 transform，fit 方法是用來進行參數學習。在目前的版本中，SimpleImputer 已經被拿來取代以前的 sklearn.preprocessing.Imputer，預設的strategy為mean，其他strategy請參關<a href="https://scikit-learn.org/stable/modules/generated/sklearn.impute.SimpleImputer.html">scikit-learn官網</a>。<br />
</p>

<p>
更詳細的使用教學請閱讀<a href="https://ithelp.ithome.com.tw/articles/10293386?sc=pt">[Day03] 拾起武器- Data Preprocessing(02)</a><br />
</p>
</div>
</div>
</div>
</div>
<div id="outline-container-org3f4d0e2" class="outline-3">
<h3 id="org3f4d0e2"><span class="section-number-3">1.4.</span> [作業]資料預處理&#xa0;&#xa0;&#xa0;<span class="tag"><span class="TNFSH">TNFSH</span></span></h3>
<div class="outline-text-3" id="text-1-4">
</div>
<div id="outline-container-orgb6ca9ba" class="outline-4">
<h4 id="orgb6ca9ba"><span class="section-number-4">1.4.1.</span> 題目</h4>
<div class="outline-text-4" id="text-1-4-1">
<p>
南一中網路書店即將開張，為了處理龐大的書單資料，資訊科教師們很無恥的把書籍資料登錄工作當成作業分派給一年級的修課學生，所謂團結力量大，一份不太可靠的<a href="Downloads/403books.csv">書目資料</a>就這麼完成了。<br />
</p>

<p>
這份<a href="Downloads/403books.csv">書目資料</a>共計271,350筆，每筆資料有以下9個欄位<br />
</p>
<ul class="org-ul">
<li>&rsquo;ISBN&rsquo;<br /></li>
<li>&rsquo;Book-Title&rsquo;<br /></li>
<li>&rsquo;Book-Author&rsquo;<br /></li>
<li>&rsquo;Year-Of-Publication&rsquo;<br /></li>
<li>&rsquo;Publisher&rsquo;<br /></li>
<li>&rsquo;Image-URL-S&rsquo;<br /></li>
<li>&rsquo;Image-URL-M&rsquo;<br /></li>
<li>&rsquo;Image-URL-L&rsquo;<br /></li>
<li>&rsquo;Book-Price&rsquo;<br /></li>
</ul>

<p>
然而，大概是因為作者群都是被迫做白工的關係，這份資料有不少缺失值與錯誤資料，錯誤的類型大概有以下幾類：<br />
</p>
<ol class="org-ol">
<li>缺失: 就是該欄位完全沒有值<br /></li>
<li>價格錯誤: 書價為0，或是書價超過20000元<br /></li>
<li>出版年代錯誤: 年代為0或是超過2024年<br /></li>
</ol>
</div>
</div>
<div id="outline-container-org6d4f9d5" class="outline-4">
<h4 id="org6d4f9d5"><span class="section-number-4">1.4.2.</span> 要求</h4>
<div class="outline-text-4" id="text-1-4-2">
<p>
請你透過colab來完成以下的任務：<br />
</p>
</div>
<div id="outline-container-orgbf64bc8" class="outline-5">
<h5 id="orgbf64bc8"><span class="section-number-5">1.4.2.1.</span> 讀檔</h5>
<div class="outline-text-5" id="text-1-4-2-1">
<p>
你可以選擇用Pandas直接讀線上的檔案，也可以選擇將檔案上傳到Google的雲端硬碟後再利用Colab來讀取。<br />
</p>
</div>
</div>
<div id="outline-container-orgf6ee0f2" class="outline-5">
<h5 id="orgf6ee0f2"><span class="section-number-5">1.4.2.2.</span> 預處理</h5>
<div class="outline-text-5" id="text-1-4-2-2">
<p>
要請你進行以下的資料預處理<br />
</p>
<ol class="org-ol">
<li>除所有有缺失值的記錄(只要有一欄有缺失值、該筆資料就整筆刪去)<br /></li>
<li>改變錯誤日期，超過2024的都改為2024<br /></li>
<li>改變錯誤日期，日期為0的都改為1900<br /></li>
<li>改變錯誤書價，超過2000的都改為1000<br /></li>
<li>改變錯誤書價，書價為0者改為100<br /></li>
</ol>
</div>
</div>
<div id="outline-container-orgbbf9e82" class="outline-5">
<h5 id="orgbbf9e82"><span class="section-number-5">1.4.2.3.</span> 輸出</h5>
<div class="outline-text-5" id="text-1-4-2-3">
<p>
最後輸出以下內容<br />
</p>
<ol class="org-ol">
<li>列出原始資料筆數<br /></li>
<li>列出修正(刪除缺失值)後的資料筆數<br /></li>
<li>列出2000年出版的書籍數量<br /></li>
<li>列出作者中有Bruce的書籍數量<br /></li>
<li>列出 500&lt;=書價&lt;=800 的書籍數量<br /></li>
<li>列出平均書價<br /></li>
</ol>
</div>
</div>
</div>
<div id="outline-container-orgfc3392b" class="outline-4">
<h4 id="orgfc3392b"><span class="section-number-4">1.4.3.</span> 參考答案</h4>
<div class="outline-text-4" id="text-1-4-3">
<p>
整份colab的程式碼要能一次執行並輸出以下結果(不能直接print我給的答案&#x2026;)<br />
</p>
<pre class="example" id="org758e6da">
原始資料筆數 271350
可用資料數: 259397
2000年出版: 16438
作者群中有Bruce: 667
800&lt;=書價&lt;=1000: 58776
平均書價: 559.23
</pre>
</div>
</div>
<div id="outline-container-org048d87c" class="outline-4">
<h4 id="org048d87c"><span class="section-number-4">1.4.4.</span> 友情提醒</h4>
<div class="outline-text-4" id="text-1-4-4">
<ul class="org-ul">
<li>資料量很大，相信我，你不會想用Excel或Numbers或Google試算表來打開它然後逐一處理&#x2026;，我試過在一台8G的Macbook Air上用Numbers打開這個csv檔，大概花了 <b>八分鐘</b> 就開起來了&#x2026;<br /></li>
<li>你可以參考<a href="https://letranger.github.io/PythonCourse/Pandas.html">Python選修Pandas教材</a>，不過這份教材只是概略描述基本功能，你可能還需要再自行Google相關的功能<br /></li>
</ul>
</div>
</div>
</div>
</div>
<div id="outline-container-org1cc8537" class="outline-2">
<h2 id="org1cc8537"><span class="section-number-2">2.</span> 資料集分類特徵編碼</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-org30f5a95" class="outline-3">
<h3 id="org30f5a95"><span class="section-number-3">2.1.</span> categorical feature</h3>
<div class="outline-text-3" id="text-2-1">
<p>
真實世界的數據集往往包含各種「類別特徵」(categorical feature)，類別特徵可再分為<br />
</p>
<ul class="org-ul">
<li>nominal feature: 名義特徵<br /></li>
<li>ordinal feature: 次序特徵<br /></li>
</ul>
<div class="org-src-container">
<pre class="src src-python"><span class="linenr"> 1: </span><span style="color: #51afef;">import</span> pandas <span style="color: #51afef;">as</span> pd
<span class="linenr"> 2: </span><span style="color: #dcaeea;">df</span> = pd.DataFrame([[<span style="color: #98be65;">'&#26481;&#21312;'</span>,<span style="color: #da8548; font-weight: bold;">150</span>,<span style="color: #da8548; font-weight: bold;">25.3</span>,<span style="color: #da8548; font-weight: bold;">45.49</span>,<span style="color: #98be65;">'&#33775;&#24264;(10&#23652;&#21547;&#20197;&#19979;&#26377;&#38651;&#26799;)'</span>,<span style="color: #da8548; font-weight: bold;">30</span>,<span style="color: #98be65;">'&#22235;&#23652;/&#20061;&#23652;'</span>,<span style="color: #98be65;">'&#20303;&#23478;&#29992;'</span>,<span style="color: #98be65;">'&#25991;&#25945;&#21312;'</span>],
<span class="linenr"> 3: </span>[<span style="color: #98be65;">'&#21271;&#21312;'</span>,<span style="color: #da8548; font-weight: bold;">321</span>,<span style="color: #da8548; font-weight: bold;">16.8</span>,<span style="color: #da8548; font-weight: bold;">78.66</span>,<span style="color: #98be65;">'&#20303;&#23429;&#22823;&#27155;(11&#23652;&#21547;&#20197;&#19978;&#26377;&#38651;&#26799;)'</span>,<span style="color: #da8548; font-weight: bold;">32</span>,<span style="color: #98be65;">'&#21313;&#19977;&#23652;/&#21313;&#22235;&#23652;'</span>,<span style="color: #98be65;">'&#21830;&#26989;&#29992;'</span>,<span style="color: #98be65;">'&#34892;&#25919;&#21312;'</span>],
<span class="linenr"> 4: </span>[<span style="color: #98be65;">'&#26481;&#21312;'</span>,<span style="color: #da8548; font-weight: bold;">900</span>,<span style="color: #da8548; font-weight: bold;">29.2</span>,<span style="color: #da8548; font-weight: bold;">30.87</span>,<span style="color: #98be65;">'&#33775;&#24264;(10&#23652;&#21547;&#20197;&#19979;&#26377;&#38651;&#26799;)'</span>,<span style="color: #da8548; font-weight: bold;">28</span>,<span style="color: #98be65;">'&#19977;&#23652;/&#20061;&#23652;'</span>,<span style="color: #98be65;">'&#20303;&#21830;&#29992;'</span>,<span style="color: #98be65;">'&#20489;&#24235;&#21312;'</span>],
<span class="linenr"> 5: </span>[<span style="color: #98be65;">'&#26032;&#24066;&#21312;'</span>,<span style="color: #da8548; font-weight: bold;">460</span>,<span style="color: #da8548; font-weight: bold;">13.4</span>,<span style="color: #da8548; font-weight: bold;">34.35</span>,<span style="color: #98be65;">'&#33775;&#24264;(10&#23652;&#21547;&#20197;&#19979;&#26377;&#38651;&#26799;)'</span>,<span style="color: #da8548; font-weight: bold;">43</span>,<span style="color: #98be65;">'&#20116;&#23652;/&#20116;&#23652;'</span>,<span style="color: #98be65;">'&#20303;&#23478;&#29992;'</span>,<span style="color: #98be65;">'&#25991;&#25945;&#21312;'</span>],
<span class="linenr"> 6: </span>[<span style="color: #98be65;">'&#23433;&#21335;&#21312;'</span>,<span style="color: #da8548; font-weight: bold;">350</span>,<span style="color: #da8548; font-weight: bold;">32.00</span>,<span style="color: #da8548; font-weight: bold;">11</span>,<span style="color: #98be65;">'&#36879;&#22825;&#21405;'</span>,<span style="color: #da8548; font-weight: bold;">57</span>,<span style="color: #98be65;">'&#20840;/&#20108;&#23652;'</span>,<span style="color: #98be65;">'&#20303;&#23478;&#29992;'</span>,<span style="color: #98be65;">'&#36786;&#26989;&#21312;'</span>],
<span class="linenr"> 7: </span>[<span style="color: #98be65;">'&#27512;&#20161;&#21312;'</span>,<span style="color: #da8548; font-weight: bold;">950</span>,<span style="color: #da8548; font-weight: bold;">22.9</span>,<span style="color: #da8548; font-weight: bold;">41.49</span>,<span style="color: #98be65;">'&#20303;&#23429;&#22823;&#27155;(11&#23652;&#21547;&#20197;&#19978;&#26377;&#38651;&#26799;)'</span>,<span style="color: #da8548; font-weight: bold;">29</span>,<span style="color: #98be65;">'&#22235;&#23652;/&#20108;&#21313;&#23652;'</span>,<span style="color: #98be65;">'&#20303;&#23478;&#29992;'</span>,<span style="color: #98be65;">'&#20445;&#35703;&#21312;'</span>],
<span class="linenr"> 8: </span>[<span style="color: #98be65;">'&#26481;&#21312;'</span>,<span style="color: #da8548; font-weight: bold;">390</span>,<span style="color: #da8548; font-weight: bold;">24.7</span>,<span style="color: #da8548; font-weight: bold;">56.38</span>,<span style="color: #98be65;">'&#20303;&#23429;&#22823;&#27155;(11&#23652;&#21547;&#20197;&#19978;&#26377;&#38651;&#26799;)'</span>,<span style="color: #da8548; font-weight: bold;">27</span>,<span style="color: #98be65;">'&#21313;&#19977;&#23652;/&#21313;&#22235;&#23652;'</span>,<span style="color: #98be65;">'&#20303;&#21830;&#29992;'</span>,<span style="color: #98be65;">'&#34892;&#25919;&#21312;'</span>],
<span class="linenr"> 9: </span>[<span style="color: #98be65;">'&#26032;&#21270;&#21312;'</span>,<span style="color: #da8548; font-weight: bold;">482</span>,<span style="color: #da8548; font-weight: bold;">15.3</span>,<span style="color: #da8548; font-weight: bold;">31.59</span>,<span style="color: #98be65;">'&#20844;&#23507;(5&#27155;&#21547;&#20197;&#19979;&#28961;&#38651;&#26799;)'</span>,<span style="color: #da8548; font-weight: bold;">42</span>,<span style="color: #98be65;">'&#19977;&#23652;/&#20116;&#23652;'</span>,<span style="color: #98be65;">'&#20303;&#23478;&#29992;'</span>,<span style="color: #98be65;">'&#20489;&#24235;&#21312;'</span>]])
<span class="linenr">10: </span>df.<span style="color: #dcaeea;">columns</span> = [<span style="color: #98be65;">'&#22320;&#27573;'</span>, <span style="color: #98be65;">'&#32317;&#20729;'</span>, <span style="color: #98be65;">'&#21934;&#20729;'</span>, <span style="color: #98be65;">'&#32317;&#38754;&#31309;'</span>, <span style="color: #98be65;">'&#22411;&#24907;'</span>, <span style="color: #98be65;">'&#23627;&#40801;'</span>, <span style="color: #98be65;">'&#27155;&#21029;'</span>, <span style="color: #98be65;">'&#29992;&#36884;'</span>, <span style="color: #98be65;">'&#22320;&#21312;&#21029;'</span>]
<span class="linenr">11: </span><span style="color: #c678dd;">print</span>(df)
</pre>
</div>

<pre class="example">
    地段   總價    單價    總面積               型態  屋齡       樓別   用途  地區別
0   東區  150  25.3  45.49    華廈(10層含以下有電梯)  30    四層/九層  住家用  文教區
1   北區  321  16.8  78.66  住宅大樓(11層含以上有電梯)  32  十三層/十四層  商業用  行政區
2   東區  900  29.2  30.87    華廈(10層含以下有電梯)  28    三層/九層  住商用  倉庫區
3  新市區  460  13.4  34.35    華廈(10層含以下有電梯)  43    五層/五層  住家用  文教區
4  安南區  350  32.0  11.00              透天厝  57     全/二層  住家用  農業區
5  歸仁區  950  22.9  41.49  住宅大樓(11層含以上有電梯)  29   四層/二十層  住家用  保護區
6   東區  390  24.7  56.38  住宅大樓(11層含以上有電梯)  27  十三層/十四層  住商用  行政區
7  新化區  482  15.3  31.59     公寓(5樓含以下無電梯)  42    三層/五層  住家用  倉庫區
</pre>
</div>
</div>
<div id="outline-container-orgaf8f24d" class="outline-3">
<h3 id="orgaf8f24d"><span class="section-number-3">2.2.</span> ordinal feature</h3>
<div class="outline-text-3" id="text-2-2">
<p>
目前的土地使用區分大致有行政區、文教區、倉庫區、風景區、農業區、河川區&#x2026;等不同型態，這裡主觀的以上述順序做為土地價值順序，也就是把&rsquo;土地區分&rsquo;這個欄位視為ordinal feature。此處自定一個 mapping dictionary，即 land_mapping，然後將 classlabel 對應到 land_mapping 中的鍵值(程式第<a href="#coderef-sizeMapping" class="coderef" onmouseover="CodeHighlightOn(this, 'coderef-sizeMapping');" onmouseout="CodeHighlightOff(this, 'coderef-sizeMapping');">10</a>行)。<br />
</p>
<div class="org-src-container">
<pre class="src src-python"><span class="linenr"> 1: </span><span style="color: #5B6268;">### </span><span style="color: #5B6268;">Mapping ordinal features</span>
<span class="linenr"> 2: </span><span style="color: #dcaeea;">land_mapping</span> = {
<span class="linenr"> 3: </span>    <span style="color: #98be65;">'&#34892;&#25919;&#21312;'</span>: <span style="color: #da8548; font-weight: bold;">7</span>,
<span class="linenr"> 4: </span>    <span style="color: #98be65;">'&#25991;&#25945;&#21312;'</span>: <span style="color: #da8548; font-weight: bold;">6</span>,
<span class="linenr"> 5: </span>    <span style="color: #98be65;">'&#20489;&#24235;&#21312;'</span>: <span style="color: #da8548; font-weight: bold;">5</span>,
<span class="linenr"> 6: </span>    <span style="color: #98be65;">'&#39080;&#26223;&#21312;'</span>: <span style="color: #da8548; font-weight: bold;">4</span>,
<span class="linenr"> 7: </span>    <span style="color: #98be65;">'&#36786;&#26989;&#21312;'</span>: <span style="color: #da8548; font-weight: bold;">3</span>,
<span class="linenr"> 8: </span>    <span style="color: #98be65;">'&#20445;&#35703;&#21312;'</span>: <span style="color: #da8548; font-weight: bold;">2</span>,
<span class="linenr"> 9: </span>    <span style="color: #98be65;">'&#27827;&#24029;&#21312;'</span>: <span style="color: #da8548; font-weight: bold;">1</span>}
<span id="coderef-sizeMapping" class="coderef-off"><span class="linenr">10: </span><span style="color: #dcaeea;">df</span>[<span style="color: #98be65;">'&#22320;&#21312;&#21029;'</span>] = df[<span style="color: #98be65;">'&#22320;&#21312;&#21029;'</span>].<span style="color: #c678dd;">map</span>(land_mapping)</span>
<span class="linenr">11: </span><span style="color: #c678dd;">print</span>(df)
</pre>
</div>

<pre class="example">
    地段   總價    單價    總面積               型態  屋齡       樓別   用途  地區別
0   東區  150  25.3  45.49    華廈(10層含以下有電梯)  30    四層/九層  住家用    6
1   北區  321  16.8  78.66  住宅大樓(11層含以上有電梯)  32  十三層/十四層  商業用    7
2   東區  900  29.2  30.87    華廈(10層含以下有電梯)  28    三層/九層  住商用    5
3  新市區  460  13.4  34.35    華廈(10層含以下有電梯)  43    五層/五層  住家用    6
4  安南區  350  32.0  11.00              透天厝  57     全/二層  住家用    3
5  歸仁區  950  22.9  41.49  住宅大樓(11層含以上有電梯)  29   四層/二十層  住家用    2
6   東區  390  24.7  56.38  住宅大樓(11層含以上有電梯)  27  十三層/十四層  住商用    7
7  新化區  482  15.3  31.59     公寓(5樓含以下無電梯)  42    三層/五層  住家用    5
</pre>
</div>
</div>
<div id="outline-container-org95d48f8" class="outline-3">
<h3 id="org95d48f8"><span class="section-number-3">2.3.</span> nominal feature</h3>
<div class="outline-text-3" id="text-2-3">
<p>
接下來我們試著處理一個nominal feature: 用途<br />
</p>
</div>
<div id="outline-container-org887de59" class="outline-4">
<h4 id="org887de59"><span class="section-number-4">2.3.1.</span> classlabel</h4>
<div class="outline-text-4" id="text-2-3-1">
<p>
許多機器學習的函式庫需要將「類別標籤」編碼為整數值。方法之一是以列舉方式為這些 nominal features 自 0 開始編號，先以 enumerate 方式建立一個 mapping dictionary: class_mapping(程式第<a href="#coderef-classMapping" class="coderef" onmouseover="CodeHighlightOn(this, 'coderef-classMapping');" onmouseout="CodeHighlightOff(this, 'coderef-classMapping');">2</a>行)，然後利用這個字典將類別特徵轉換為整數值。<br />
</p>
<div class="org-src-container">
<pre class="src src-python"><span class="linenr">1: </span><span style="color: #dcaeea;">class_mapping</span> = {
<span id="coderef-classMapping" class="coderef-off"><span class="linenr">2: </span>    label: idx <span style="color: #51afef;">for</span> idx, label <span style="color: #51afef;">in</span> <span style="color: #c678dd;">enumerate</span>(np.unique(df[<span style="color: #98be65;">'&#29992;&#36884;'</span>]))</span>
<span class="linenr">3: </span>}
<span class="linenr">4: </span><span style="color: #c678dd;">print</span>(class_mapping)
<span class="linenr">5: </span><span style="color: #5B6268;"># </span><span style="color: #5B6268;">&#23559;&#39006;&#21029;&#29305;&#24501;&#36681;&#25563;&#28858;&#25972;&#25976;&#20540;</span>
<span class="linenr">6: </span><span style="color: #dcaeea;">df</span>[<span style="color: #98be65;">'&#29992;&#36884;'</span>] = df[<span style="color: #98be65;">'&#29992;&#36884;'</span>].<span style="color: #c678dd;">map</span>(class_mapping)
<span class="linenr">7: </span><span style="color: #c678dd;">print</span>(df)
</pre>
</div>

<pre class="example" id="orge707342">
{'住商用': 0, '住家用': 1, '商業用': 2}
    地段   總價    單價    總面積               型態  屋齡       樓別  用途  地區別
0   東區  150  25.3  45.49    華廈(10層含以下有電梯)  30    四層/九層   1    6
1   北區  321  16.8  78.66  住宅大樓(11層含以上有電梯)  32  十三層/十四層   2    7
2   東區  900  29.2  30.87    華廈(10層含以下有電梯)  28    三層/九層   0    5
3  新市區  460  13.4  34.35    華廈(10層含以下有電梯)  43    五層/五層   1    6
4  安南區  350  32.0  11.00              透天厝  57     全/二層   1    3
5  歸仁區  950  22.9  41.49  住宅大樓(11層含以上有電梯)  29   四層/二十層   1    2
6   東區  390  24.7  56.38  住宅大樓(11層含以上有電梯)  27  十三層/十四層   0    7
7  新化區  482  15.3  31.59     公寓(5樓含以下無電梯)  42    三層/五層   1    5
</pre>

<p>
能將類別轉成整數，也要能將整數轉回類別。此處可以利用已產生的對應字典，藉由借調 key-value 來產生「反轉字典」(第<a href="#coderef-invClassMapping" class="coderef" onmouseover="CodeHighlightOn(this, 'coderef-invClassMapping');" onmouseout="CodeHighlightOff(this, 'coderef-invClassMapping');">2</a>行)，將對調產生的整數還原回原始類別特徵。<br />
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="linenr">1: </span><span style="color: #5B6268;"># </span><span style="color: #5B6268;">&#29986;&#29983;&#21453;&#36681;&#23383;&#20856;&#65292;&#23559;&#25972;&#25976;&#36996;&#21407;&#33267;&#21407;&#22987;&#30340;&#39006;&#21029;&#27161;&#31844;</span>
<span id="coderef-invClassMapping" class="coderef-off"><span class="linenr">2: </span><span style="color: #dcaeea;">inv_class_mapping</span> = {v: k <span style="color: #51afef;">for</span> k, v <span style="color: #51afef;">in</span> class_mapping.items()}</span>
<span class="linenr">3: </span><span style="color: #c678dd;">print</span>(inv_class_mapping)
<span class="linenr">4: </span><span style="color: #dcaeea;">df</span>[<span style="color: #98be65;">'&#29992;&#36884;'</span>] = df[<span style="color: #98be65;">'&#29992;&#36884;'</span>].<span style="color: #c678dd;">map</span>(inv_class_mapping)
<span class="linenr">5: </span><span style="color: #c678dd;">print</span>(df)
</pre>
</div>

<pre class="example" id="org195ca98">
{0: '住商用', 1: '住家用', 2: '商業用'}
    地段   總價    單價    總面積               型態  屋齡       樓別   用途  地區別
0   東區  150  25.3  45.49    華廈(10層含以下有電梯)  30    四層/九層  住家用    6
1   北區  321  16.8  78.66  住宅大樓(11層含以上有電梯)  32  十三層/十四層  商業用    7
2   東區  900  29.2  30.87    華廈(10層含以下有電梯)  28    三層/九層  住商用    5
3  新市區  460  13.4  34.35    華廈(10層含以下有電梯)  43    五層/五層  住家用    6
4  安南區  350  32.0  11.00              透天厝  57     全/二層  住家用    3
5  歸仁區  950  22.9  41.49  住宅大樓(11層含以上有電梯)  29   四層/二十層  住家用    2
6   東區  390  24.7  56.38  住宅大樓(11層含以上有電梯)  27  十三層/十四層  住商用    7
7  新化區  482  15.3  31.59     公寓(5樓含以下無電梯)  42    三層/五層  住家用    5
</pre>
</div>
</div>
<div id="outline-container-org068725f" class="outline-4">
<h4 id="org068725f"><span class="section-number-4">2.3.2.</span> scikit-learn LabelEncoder</h4>
<div class="outline-text-4" id="text-2-3-2">
<p>
事實上，scikit-learn 中有一個更為方便的 LabelEncoder 類別則可以直接完成上述工作(第<a href="#coderef-labelEncoder" class="coderef" onmouseover="CodeHighlightOn(this, 'coderef-labelEncoder');" onmouseout="CodeHighlightOff(this, 'coderef-labelEncoder');">4</a>行)。<br />
</p>
<div class="org-src-container">
<pre class="src src-python"><span class="linenr">1: </span><span style="color: #5B6268;"># </span><span style="color: #5B6268;">Label encoding with sklearn's LabelEncoder</span>
<span class="linenr">2: </span><span style="color: #51afef;">from</span> sklearn.preprocessing <span style="color: #51afef;">import</span> LabelEncoder
<span class="linenr">3: </span><span style="color: #dcaeea;">le</span> = LabelEncoder()
<span id="coderef-labelEncoder" class="coderef-off"><span class="linenr">4: </span><span style="color: #dcaeea;">y</span> = le.fit_transform(df[<span style="color: #98be65;">'&#29992;&#36884;'</span>].values)</span>
<span class="linenr">5: </span><span style="color: #c678dd;">print</span>(y)
<span class="linenr">6: </span><span style="color: #dcaeea;">df</span>[<span style="color: #98be65;">'&#29992;&#36884;'</span>] = y
<span class="linenr">7: </span><span style="color: #c678dd;">print</span>(df) <span style="color: #5B6268;"># </span><span style="color: #5B6268;">&#39006;&#21029;&#33287;&#25976;&#23383;&#30340;&#23565;&#25033;&#19981;&#19968;&#23450;&#33287;&#33258;&#35330;&#23383;&#20856;&#19968;&#33268;</span>
</pre>
</div>

<pre class="example" id="org453e099">
[1 2 0 1 1 1 0 1]
    地段   總價    單價    總面積               型態  屋齡       樓別  用途  地區別
0   東區  150  25.3  45.49    華廈(10層含以下有電梯)  30    四層/九層   1    6
1   北區  321  16.8  78.66  住宅大樓(11層含以上有電梯)  32  十三層/十四層   2    7
2   東區  900  29.2  30.87    華廈(10層含以下有電梯)  28    三層/九層   0    5
3  新市區  460  13.4  34.35    華廈(10層含以下有電梯)  43    五層/五層   1    6
4  安南區  350  32.0  11.00              透天厝  57     全/二層   1    3
5  歸仁區  950  22.9  41.49  住宅大樓(11層含以上有電梯)  29   四層/二十層   1    2
6   東區  390  24.7  56.38  住宅大樓(11層含以上有電梯)  27  十三層/十四層   0    7
7  新化區  482  15.3  31.59     公寓(5樓含以下無電梯)  42    三層/五層   1    5
</pre>

<p>
反向編碼<br />
</p>
<div class="org-src-container">
<pre class="src src-python"><span class="linenr">1: </span><span style="color: #5B6268;"># </span><span style="color: #5B6268;">&#21453;&#21521;&#32534;&#30908;&#65292;&#23559;&#25976;&#20540;&#32232;&#30908;&#36681;&#25563;&#22238;&#21407;&#22987;&#39006;&#21029;</span>
<span class="linenr">2: </span><span style="color: #dcaeea;">original_labels</span> = le.inverse_transform(y)
<span class="linenr">3: </span><span style="color: #c678dd;">print</span>(<span style="color: #98be65;">"&#21453;&#36681;&#32232;&#30908;:"</span>, original_labels)
<span class="linenr">4: </span>
<span class="linenr">5: </span><span style="color: #dcaeea;">df</span>[<span style="color: #98be65;">'&#21407;&#20358;&#30340;&#29992;&#36884;&#27396;'</span>] = original_labels
<span class="linenr">6: </span><span style="color: #c678dd;">print</span>(df)
</pre>
</div>

<pre class="example" id="org1d9f412">
反轉编碼: ['住家用' '商業用' '住商用' '住家用' '住家用' '住家用' '住商用' '住家用']
    地段   總價    單價    總面積               型態  屋齡       樓別  用途  地區別 原來的用途欄
0   東區  150  25.3  45.49    華廈(10層含以下有電梯)  30    四層/九層   1    6    住家用
1   北區  321  16.8  78.66  住宅大樓(11層含以上有電梯)  32  十三層/十四層   2    7    商業用
2   東區  900  29.2  30.87    華廈(10層含以下有電梯)  28    三層/九層   0    5    住商用
3  新市區  460  13.4  34.35    華廈(10層含以下有電梯)  43    五層/五層   1    6    住家用
4  安南區  350  32.0  11.00              透天厝  57     全/二層   1    3    住家用
5  歸仁區  950  22.9  41.49  住宅大樓(11層含以上有電梯)  29   四層/二十層   1    2    住家用
6   東區  390  24.7  56.38  住宅大樓(11層含以上有電梯)  27  十三層/十四層   0    7    住商用
7  新化區  482  15.3  31.59     公寓(5樓含以下無電梯)  42    三層/五層   1    5    住家用
</pre>

<p>
你有看出這樣轉換會有什麼問題嗎?<br />
</p>
</div>
</div>
</div>
<div id="outline-container-org0c0b51c" class="outline-3">
<h3 id="org0c0b51c"><span class="section-number-3">2.4.</span> One-Hot Encoding</h3>
<div class="outline-text-3" id="text-2-4">
<p>
在上面的例子中，我們以scikit-learn 的 LabelENcoder 類別將「類別特徵」編碼為整數值，但這樣會引發另一個問題:原本無序的類別變項就變成有序變項了。如果我們將上述資料中的 <b>地段</b> 特徵轉換為整數值，如下：<br />
</p>
<div class="org-src-container">
<pre class="src src-python"><span class="linenr">1: </span><span style="color: #dcaeea;">X</span> = df[[<span style="color: #98be65;">'&#22320;&#27573;'</span>]].values
<span class="linenr">2: </span><span style="color: #5B6268;"># </span><span style="color: #5B6268;">&#20197;LabelEncoder&#36681;&#25563;</span>
<span class="linenr">3: </span><span style="color: #51afef;">from</span> sklearn.preprocessing <span style="color: #51afef;">import</span> LabelEncoder
<span class="linenr">4: </span><span style="color: #dcaeea;">le</span> = LabelEncoder()
<span class="linenr">5: </span><span style="color: #c678dd;">print</span>(X)
<span class="linenr">6: </span><span style="color: #c678dd;">print</span>(le.fit_transform(X[:,<span style="color: #da8548; font-weight: bold;">0</span>]))
</pre>
</div>

<pre class="example">
[['東區']
 ['北區']
 ['東區']
 ['新市區']
 ['安南區']
 ['歸仁區']
 ['東區']
 ['新化區']]
[4 0 4 3 1 5 4 2]
</pre>


<p>
由輸出結果可以發現，經過類別編碼後的地段特徵，由原本不具次序的特徵變成存在大小關係(歸仁區&gt;東區&gt;b新市區&#x2026;)，這明顯會影響 model 運算的結果。<br />
</p>

<p>
針對此一問題，常見的解決方案是 one-hot encoding(獨熱編碼&#x2013;真是直白的翻譯啊啊啊&#x2026;.)，其原理是：對特徵值中的每個值，建立一個新的「虛擬特徵」(dummy feature)。<br />
</p>
</div>
<div id="outline-container-org4d53aa0" class="outline-4">
<h4 id="org4d53aa0"><span class="section-number-4">2.4.1.</span> 以pandas get_dummies()進行One Hot Encoding</h4>
<div class="outline-text-4" id="text-2-4-1">
<p>
利用 Pandas 套件的 get_dummies 類別，直接將類別資料轉成二進位類型，即One-Hot encoding。這種轉換只有字串數據會被轉換，其他內容則否。<br />
</p>
<div class="org-src-container">
<pre class="src src-python"><span class="linenr">1: </span><span style="color: #c678dd;">print</span>(<span style="color: #98be65;">'===&#21407;&#22987;&#36039;&#26009;==='</span>)
<span class="linenr">2: </span><span style="color: #c678dd;">print</span>(df)
<span class="linenr">3: </span>
<span class="linenr">4: </span><span style="color: #dcaeea;">OheDf</span> = pd.get_dummies(df, columns=[<span style="color: #98be65;">'&#22320;&#27573;'</span>])
<span class="linenr">5: </span><span style="color: #c678dd;">print</span>(<span style="color: #98be65;">'===&#36681;&#25563;&#24460;&#36039;&#26009;==='</span>)
<span class="linenr">6: </span><span style="color: #c678dd;">print</span>(OheDf)
</pre>
</div>

<pre class="example" id="org70d9ee4">
===原始資料===
    地段   總價    單價    總面積               型態  屋齡       樓別  用途  地區別 原來的用途欄
0   東區  150  25.3  45.49    華廈(10層含以下有電梯)  30    四層/九層   1    6    住家用
1   北區  321  16.8  78.66  住宅大樓(11層含以上有電梯)  32  十三層/十四層   2    7    商業用
2   東區  900  29.2  30.87    華廈(10層含以下有電梯)  28    三層/九層   0    5    住商用
3  新市區  460  13.4  34.35    華廈(10層含以下有電梯)  43    五層/五層   1    6    住家用
4  安南區  350  32.0  11.00              透天厝  57     全/二層   1    3    住家用
5  歸仁區  950  22.9  41.49  住宅大樓(11層含以上有電梯)  29   四層/二十層   1    2    住家用
6   東區  390  24.7  56.38  住宅大樓(11層含以上有電梯)  27  十三層/十四層   0    7    住商用
7  新化區  482  15.3  31.59     公寓(5樓含以下無電梯)  42    三層/五層   1    5    住家用
===轉換後資料===
    總價    單價    總面積               型態  屋齡  ... 地段_安南區  地段_新化區  地段_新市區  地段_東區  地段_歸仁區
0  150  25.3  45.49    華廈(10層含以下有電梯)  30  ...  False   False   False   True   False
1  321  16.8  78.66  住宅大樓(11層含以上有電梯)  32  ...  False   False   False  False   False
2  900  29.2  30.87    華廈(10層含以下有電梯)  28  ...  False   False   False   True   False
3  460  13.4  34.35    華廈(10層含以下有電梯)  43  ...  False   False    True  False   False
4  350  32.0  11.00              透天厝  57  ...   True   False   False  False   False
5  950  22.9  41.49  住宅大樓(11層含以上有電梯)  29  ...  False   False   False  False    True
6  390  24.7  56.38  住宅大樓(11層含以上有電梯)  27  ...  False   False   False   True   False
7  482  15.3  31.59     公寓(5樓含以下無電梯)  42  ...  False    True   False  False   False

[8 rows x 15 columns]
</pre>
</div>
</div>
<div id="outline-container-orgb77852d" class="outline-4">
<h4 id="orgb77852d"><span class="section-number-4">2.4.2.</span> 以scikit-learn ColumnTransformer 進行One-Hot Encoding</h4>
<div class="outline-text-4" id="text-2-4-2">
<p>
利用 ColumnTransformer 函式庫的 ColumnTransformer 類別，將特徵值轉換 One-Hot Encoding 的對應矩陣，如程式第<a href="#coderef-FitTransform" class="coderef" onmouseover="CodeHighlightOn(this, 'coderef-FitTransform');" onmouseout="CodeHighlightOff(this, 'coderef-FitTransform');">27</a>行。<br />
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="linenr"> 1: </span><span style="color: #51afef;">from</span> sklearn.preprocessing <span style="color: #51afef;">import</span> OneHotEncoder
<span class="linenr"> 2: </span><span style="color: #51afef;">import</span> pandas <span style="color: #51afef;">as</span> pd
<span class="linenr"> 3: </span>
<span class="linenr"> 4: </span><span style="color: #dcaeea;">df</span> = pd.DataFrame([[<span style="color: #98be65;">'&#26481;&#21312;'</span>,<span style="color: #da8548; font-weight: bold;">150</span>,<span style="color: #da8548; font-weight: bold;">25.3</span>,<span style="color: #da8548; font-weight: bold;">45.49</span>,<span style="color: #98be65;">'&#33775;&#24264;(10&#23652;&#21547;&#20197;&#19979;&#26377;&#38651;&#26799;)'</span>,<span style="color: #da8548; font-weight: bold;">30</span>,<span style="color: #98be65;">'&#22235;&#23652;/&#20061;&#23652;'</span>,<span style="color: #98be65;">'&#20303;&#23478;&#29992;'</span>,<span style="color: #98be65;">'&#25991;&#25945;&#21312;'</span>],
<span class="linenr"> 5: </span>[<span style="color: #98be65;">'&#21271;&#21312;'</span>,<span style="color: #da8548; font-weight: bold;">321</span>,<span style="color: #da8548; font-weight: bold;">16.8</span>,<span style="color: #da8548; font-weight: bold;">78.66</span>,<span style="color: #98be65;">'&#20303;&#23429;&#22823;&#27155;(11&#23652;&#21547;&#20197;&#19978;&#26377;&#38651;&#26799;)'</span>,<span style="color: #da8548; font-weight: bold;">32</span>,<span style="color: #98be65;">'&#21313;&#19977;&#23652;/&#21313;&#22235;&#23652;'</span>,<span style="color: #98be65;">'&#21830;&#26989;&#29992;'</span>,<span style="color: #98be65;">'&#34892;&#25919;&#21312;'</span>],
<span class="linenr"> 6: </span>[<span style="color: #98be65;">'&#26481;&#21312;'</span>,<span style="color: #da8548; font-weight: bold;">900</span>,<span style="color: #da8548; font-weight: bold;">29.2</span>,<span style="color: #da8548; font-weight: bold;">30.87</span>,<span style="color: #98be65;">'&#33775;&#24264;(10&#23652;&#21547;&#20197;&#19979;&#26377;&#38651;&#26799;)'</span>,<span style="color: #da8548; font-weight: bold;">28</span>,<span style="color: #98be65;">'&#19977;&#23652;/&#20061;&#23652;'</span>,<span style="color: #98be65;">'&#20303;&#21830;&#29992;'</span>,<span style="color: #98be65;">'&#20489;&#24235;&#21312;'</span>],
<span class="linenr"> 7: </span>[<span style="color: #98be65;">'&#26032;&#24066;&#21312;'</span>,<span style="color: #da8548; font-weight: bold;">460</span>,<span style="color: #da8548; font-weight: bold;">13.4</span>,<span style="color: #da8548; font-weight: bold;">34.35</span>,<span style="color: #98be65;">'&#33775;&#24264;(10&#23652;&#21547;&#20197;&#19979;&#26377;&#38651;&#26799;)'</span>,<span style="color: #da8548; font-weight: bold;">43</span>,<span style="color: #98be65;">'&#20116;&#23652;/&#20116;&#23652;'</span>,<span style="color: #98be65;">'&#20303;&#23478;&#29992;'</span>,<span style="color: #98be65;">'&#25991;&#25945;&#21312;'</span>],
<span class="linenr"> 8: </span>[<span style="color: #98be65;">'&#23433;&#21335;&#21312;'</span>,<span style="color: #da8548; font-weight: bold;">350</span>,<span style="color: #da8548; font-weight: bold;">32.00</span>,<span style="color: #da8548; font-weight: bold;">11</span>,<span style="color: #98be65;">'&#36879;&#22825;&#21405;'</span>,<span style="color: #da8548; font-weight: bold;">57</span>,<span style="color: #98be65;">'&#20840;/&#20108;&#23652;'</span>,<span style="color: #98be65;">'&#20303;&#23478;&#29992;'</span>,<span style="color: #98be65;">'&#36786;&#26989;&#21312;'</span>],
<span class="linenr"> 9: </span>[<span style="color: #98be65;">'&#27512;&#20161;&#21312;'</span>,<span style="color: #da8548; font-weight: bold;">950</span>,<span style="color: #da8548; font-weight: bold;">22.9</span>,<span style="color: #da8548; font-weight: bold;">41.49</span>,<span style="color: #98be65;">'&#20303;&#23429;&#22823;&#27155;(11&#23652;&#21547;&#20197;&#19978;&#26377;&#38651;&#26799;)'</span>,<span style="color: #da8548; font-weight: bold;">29</span>,<span style="color: #98be65;">'&#22235;&#23652;/&#20108;&#21313;&#23652;'</span>,<span style="color: #98be65;">'&#20303;&#23478;&#29992;'</span>,<span style="color: #98be65;">'&#20445;&#35703;&#21312;'</span>],
<span class="linenr">10: </span>[<span style="color: #98be65;">'&#26481;&#21312;'</span>,<span style="color: #da8548; font-weight: bold;">390</span>,<span style="color: #da8548; font-weight: bold;">24.7</span>,<span style="color: #da8548; font-weight: bold;">56.38</span>,<span style="color: #98be65;">'&#20303;&#23429;&#22823;&#27155;(11&#23652;&#21547;&#20197;&#19978;&#26377;&#38651;&#26799;)'</span>,<span style="color: #da8548; font-weight: bold;">27</span>,<span style="color: #98be65;">'&#21313;&#19977;&#23652;/&#21313;&#22235;&#23652;'</span>,<span style="color: #98be65;">'&#20303;&#21830;&#29992;'</span>,<span style="color: #98be65;">'&#34892;&#25919;&#21312;'</span>],
<span class="linenr">11: </span>[<span style="color: #98be65;">'&#26032;&#21270;&#21312;'</span>,<span style="color: #da8548; font-weight: bold;">482</span>,<span style="color: #da8548; font-weight: bold;">15.3</span>,<span style="color: #da8548; font-weight: bold;">31.59</span>,<span style="color: #98be65;">'&#20844;&#23507;(5&#27155;&#21547;&#20197;&#19979;&#28961;&#38651;&#26799;)'</span>,<span style="color: #da8548; font-weight: bold;">42</span>,<span style="color: #98be65;">'&#19977;&#23652;/&#20116;&#23652;'</span>,<span style="color: #98be65;">'&#20303;&#23478;&#29992;'</span>,<span style="color: #98be65;">'&#20489;&#24235;&#21312;'</span>]])
<span class="linenr">12: </span>df.<span style="color: #dcaeea;">columns</span> = [<span style="color: #98be65;">'&#22320;&#27573;'</span>, <span style="color: #98be65;">'&#32317;&#20729;'</span>, <span style="color: #98be65;">'&#21934;&#20729;'</span>, <span style="color: #98be65;">'&#32317;&#38754;&#31309;'</span>, <span style="color: #98be65;">'&#22411;&#24907;'</span>, <span style="color: #98be65;">'&#23627;&#40801;'</span>, <span style="color: #98be65;">'&#27155;&#21029;'</span>, <span style="color: #98be65;">'&#29992;&#36884;'</span>, <span style="color: #98be65;">'&#22320;&#21312;&#21029;'</span>]
<span class="linenr">13: </span>
<span class="linenr">14: </span><span style="color: #c678dd;">print</span>(<span style="color: #98be65;">'===&#21407;&#22987;&#36039;&#26009;==='</span>)
<span class="linenr">15: </span><span style="color: #c678dd;">print</span>(df[[<span style="color: #98be65;">'&#22320;&#27573;'</span>]])
<span class="linenr">16: </span>
<span class="linenr">17: </span><span style="color: #51afef;">from</span> sklearn.compose <span style="color: #51afef;">import</span> ColumnTransformer
<span class="linenr">18: </span>
<span class="linenr">19: </span><span style="color: #dcaeea;">X</span> = df[[<span style="color: #98be65;">'&#22320;&#27573;'</span>]].values
<span class="linenr">20: </span><span style="color: #dcaeea;">ct</span> = ColumnTransformer(
<span class="linenr">21: </span>    <span style="color: #5B6268;"># </span><span style="color: #5B6268;">The column numbers to be transformed (here is [0] but can be [0, 1, 3])</span>
<span class="linenr">22: </span>    <span style="color: #5B6268;"># </span><span style="color: #5B6268;">Leave the rest of the columns untouched</span>
<span class="linenr">23: </span>    [(<span style="color: #98be65;">'OneHot'</span>, OneHotEncoder(), [<span style="color: #da8548; font-weight: bold;">0</span>])], remainder=<span style="color: #98be65;">'passthrough'</span>
<span class="linenr">24: </span>)
<span class="linenr">25: </span><span style="color: #c678dd;">print</span>(<span style="color: #98be65;">'===&#36681;&#25563;&#24460;&#30340;one-hot encoding&#36039;&#26009;==='</span>)
<span class="linenr">26: </span><span style="color: #dcaeea;">X_transformed</span> = ct.fit_transform(X)
<span id="coderef-FitTransform" class="coderef-off"><span class="linenr">27: </span><span style="color: #c678dd;">print</span>(ct.fit_transform(X))</span>
<span class="linenr">28: </span>
<span class="linenr">29: </span><span style="color: #5B6268;"># </span><span style="color: #5B6268;">&#23559;&#31232;&#30095;&#30697;&#38499;&#36996;&#21407;&#28858;&#23494;&#38598;&#30697;&#38499;(&#38750;&#24517;&#38920;&#65292;&#21482;&#26159;&#35731;&#25105;&#20497;&#23481;&#26131;&#30475;&#19968;&#19979;&#32080;&#26524;)</span>
<span class="linenr">30: </span><span style="color: #dcaeea;">X_dense</span> = X_transformed.toarray()
<span class="linenr">31: </span><span style="color: #5B6268;"># </span><span style="color: #5B6268;">&#36681;&#28858;dataframe&#12289;&#21152;&#20837;column name</span>
<span class="linenr">32: </span><span style="color: #dcaeea;">encoded_columns</span> = ct.named_transformers_[<span style="color: #98be65;">'OneHot'</span>].get_feature_names_out([<span style="color: #98be65;">'&#22320;&#27573;'</span>])
<span class="linenr">33: </span><span style="color: #dcaeea;">df_encoded</span> = pd.DataFrame(X_dense, columns=encoded_columns)
<span class="linenr">34: </span>
<span class="linenr">35: </span><span style="color: #c678dd;">print</span>(<span style="color: #98be65;">'===One-Hot&#32467;&#26524;==='</span>)
<span class="linenr">36: </span><span style="color: #c678dd;">print</span>(df_encoded)
</pre>
</div>

<pre class="example" id="orgdd4edf9">
===原始資料===
    地段
0   東區
1   北區
2   東區
3  新市區
4  安南區
5  歸仁區
6   東區
7  新化區
===轉換後的one-hot encoding資料===
  (0, 4)	1.0
  (1, 0)	1.0
  (2, 4)	1.0
  (3, 3)	1.0
  (4, 1)	1.0
  (5, 5)	1.0
  (6, 4)	1.0
  (7, 2)	1.0
===One-Hot结果===
   地段_北區  地段_安南區  地段_新化區  地段_新市區  地段_東區  地段_歸仁區
0    0.0     0.0     0.0     0.0    1.0     0.0
1    1.0     0.0     0.0     0.0    0.0     0.0
2    0.0     0.0     0.0     0.0    1.0     0.0
3    0.0     0.0     0.0     1.0    0.0     0.0
4    0.0     1.0     0.0     0.0    0.0     0.0
5    0.0     0.0     0.0     0.0    0.0     1.0
6    0.0     0.0     0.0     0.0    1.0     0.0
7    0.0     0.0     1.0     0.0    0.0     0.0
</pre>
</div>
</div>
<div id="outline-container-orgaff21ad" class="outline-4">
<h4 id="orgaff21ad"><span class="section-number-4">2.4.3.</span> scikit learn OneHotEncoder()</h4>
<div class="outline-text-4" id="text-2-4-3">
<div class="org-src-container">
<pre class="src src-python"><span class="linenr">1: </span><span style="color: #5B6268;"># </span><span style="color: #5B6268;">&#21021;&#22987;&#21270; OneHotEncoder</span>
<span class="linenr">2: </span><span style="color: #dcaeea;">encoder</span> = OneHotEncoder()
<span class="linenr">3: </span><span style="color: #dcaeea;">encoded_colors</span> = encoder.fit_transform(df[[<span style="color: #98be65;">'&#22320;&#27573;'</span>]])
<span class="linenr">4: </span><span style="color: #dcaeea;">encoded_df</span> = pd.DataFrame(encoded_colors.toarray(), columns=encoder.get_feature_names_out([<span style="color: #98be65;">'&#22320;&#27573;'</span>]))
<span class="linenr">5: </span>
<span class="linenr">6: </span><span style="color: #dcaeea;">df_encoded</span> = pd.concat([df.drop(columns=[<span style="color: #98be65;">'&#22320;&#27573;'</span>]), encoded_df], axis=<span style="color: #da8548; font-weight: bold;">1</span>)
<span class="linenr">7: </span><span style="color: #c678dd;">print</span>(df_encoded)
</pre>
</div>

<pre class="example" id="org30b9229">
    總價    單價    總面積               型態  屋齡  ... 地段_安南區 地段_新化區 地段_新市區  地段_東區  地段_歸仁區
0  150  25.3  45.49    華廈(10層含以下有電梯)  30  ...    0.0    0.0    0.0    1.0     0.0
1  321  16.8  78.66  住宅大樓(11層含以上有電梯)  32  ...    0.0    0.0    0.0    0.0     0.0
2  900  29.2  30.87    華廈(10層含以下有電梯)  28  ...    0.0    0.0    0.0    1.0     0.0
3  460  13.4  34.35    華廈(10層含以下有電梯)  43  ...    0.0    0.0    1.0    0.0     0.0
4  350  32.0  11.00              透天厝  57  ...    1.0    0.0    0.0    0.0     0.0
5  950  22.9  41.49  住宅大樓(11層含以上有電梯)  29  ...    0.0    0.0    0.0    0.0     1.0
6  390  24.7  56.38  住宅大樓(11層含以上有電梯)  27  ...    0.0    0.0    0.0    1.0     0.0
7  482  15.3  31.59     公寓(5樓含以下無電梯)  42  ...    0.0    1.0    0.0    0.0     0.0

[8 rows x 14 columns]
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org8c2f78f" class="outline-2">
<h2 id="org8c2f78f"><span class="section-number-2">3.</span> 特徵縮放(Feature scaling)</h2>
<div class="outline-text-2" id="text-3">
<p>
當我們在比較分析兩組數據資料時，可能會遭遇因單位的不同(例如：身高與體重)，或數字大小的代表性不同(例如：粉專1萬人與滿足感0.8)，造成各自變化的程度不一，進而影響統計分析的結果；為解決此類的問題，我們可利用資料的正規化(Normalization)與標準化(Standardization)來進行數據的比較及分析<sup><a id="fnr.1" class="footref" href="#fn.1" role="doc-backlink">1</a></sup>。<br />
</p>

<p>
「特徵縮放」(Feature scaling)是資料預處理的一個關鍵，「決策樹」和「隨機森林」是極少數無需進行 feature scaling 的分類技術；對多數機器學習演算法而言，若特徵值經過適當的縮放，都能有更佳成效。Feature scaling 的重要性可以以下例子看出，假設有兩個特徵值(a, b)，其中 a 的測量範圍為 1 到 10，b 的測量值範圍為 1 到 100000，以典型分類演算法的做法，一定是忙於最佳化特徵值 b；若以 KNN 的演算法，也會被特徵值 b 所支配。<br />
</p>

<p>
在機器學習演算法中，將數值縮放到同一scale能帶給模型下面兩個好處：<br />
</p>
<ol class="org-ol">
<li>提升模型的收斂速度<br />
在建構機器學習模型時，我們會利用梯度下降法(Gradient Descent)來計算成本函數(Cost Function)的最佳解；假設我們現有兩個特徵值 x1 in [0,1] 與 x2 in [0,10000]，則在 x1-x2 平面上成本函數的等高線會呈窄長型，導致需較多的迭代步驟，另外也可能導致無法收斂的情況發生。因此，若將資料標準化，則能減少梯度下降法的收斂時間。<br /></li>
<li>提高模型的精準度<br />
將特徵值 x1 及 x2 餵入一些需計算樣本彼此的距離(例如:歐氏距離)分類器演算法中，則 x2 的影響很可能將遠大於 x1，若實際上 x1 的指標意義及重要性高於 x2，這將導致我們分析的結果失真。因此，資料的標準化是有必要的，可讓每個特徵值對結果做出相近程度的貢獻。<br /></li>
</ol>
</div>
<div id="outline-container-orga4765ce" class="outline-3">
<h3 id="orga4765ce"><span class="section-number-3">3.1.</span> 常態化(Normalization)</h3>
<div class="outline-text-3" id="text-3-1">
<p>
將特徵值縮化為 0~1 間，這是「最小最大縮放」(min-max scaling)的一個特例，某一特徵值的常態化做法如下：<br />
\[x_{norm}^i = \frac{x^i-x_{min}}{x_{max}-x_{min}}\]<br />
若以 scikit-learn 套件來完成實作，其程式碼如下：<br />
</p>
<div class="org-src-container">
<pre class="src src-python"><span class="linenr"> 1: </span><span style="color: #51afef;">from</span> sklearn.preprocessing <span style="color: #51afef;">import</span> MinMaxScaler
<span class="linenr"> 2: </span><span style="color: #51afef;">import</span> pandas <span style="color: #51afef;">as</span> pd
<span class="linenr"> 3: </span><span style="color: #dcaeea;">df</span> = pd.DataFrame([[<span style="color: #98be65;">'&#26481;&#21312;'</span>,<span style="color: #da8548; font-weight: bold;">150</span>,<span style="color: #da8548; font-weight: bold;">25.3</span>,<span style="color: #da8548; font-weight: bold;">45.49</span>,<span style="color: #98be65;">'&#33775;&#24264;(10&#23652;&#21547;&#20197;&#19979;&#26377;&#38651;&#26799;)'</span>,<span style="color: #da8548; font-weight: bold;">30</span>,<span style="color: #98be65;">'&#22235;&#23652;/&#20061;&#23652;'</span>,<span style="color: #98be65;">'&#20303;&#23478;&#29992;'</span>,<span style="color: #98be65;">'&#25991;&#25945;&#21312;'</span>],
<span class="linenr"> 4: </span>[<span style="color: #98be65;">'&#21271;&#21312;'</span>,<span style="color: #da8548; font-weight: bold;">321</span>,<span style="color: #da8548; font-weight: bold;">16.8</span>,<span style="color: #da8548; font-weight: bold;">78.66</span>,<span style="color: #98be65;">'&#20303;&#23429;&#22823;&#27155;(11&#23652;&#21547;&#20197;&#19978;&#26377;&#38651;&#26799;)'</span>,<span style="color: #da8548; font-weight: bold;">32</span>,<span style="color: #98be65;">'&#21313;&#19977;&#23652;/&#21313;&#22235;&#23652;'</span>,<span style="color: #98be65;">'&#21830;&#26989;&#29992;'</span>,<span style="color: #98be65;">'&#34892;&#25919;&#21312;'</span>],
<span class="linenr"> 5: </span>[<span style="color: #98be65;">'&#26481;&#21312;'</span>,<span style="color: #da8548; font-weight: bold;">900</span>,<span style="color: #da8548; font-weight: bold;">29.2</span>,<span style="color: #da8548; font-weight: bold;">30.87</span>,<span style="color: #98be65;">'&#33775;&#24264;(10&#23652;&#21547;&#20197;&#19979;&#26377;&#38651;&#26799;)'</span>,<span style="color: #da8548; font-weight: bold;">28</span>,<span style="color: #98be65;">'&#19977;&#23652;/&#20061;&#23652;'</span>,<span style="color: #98be65;">'&#20303;&#21830;&#29992;'</span>,<span style="color: #98be65;">'&#20489;&#24235;&#21312;'</span>],
<span class="linenr"> 6: </span>[<span style="color: #98be65;">'&#26032;&#24066;&#21312;'</span>,<span style="color: #da8548; font-weight: bold;">460</span>,<span style="color: #da8548; font-weight: bold;">13.4</span>,<span style="color: #da8548; font-weight: bold;">34.35</span>,<span style="color: #98be65;">'&#33775;&#24264;(10&#23652;&#21547;&#20197;&#19979;&#26377;&#38651;&#26799;)'</span>,<span style="color: #da8548; font-weight: bold;">43</span>,<span style="color: #98be65;">'&#20116;&#23652;/&#20116;&#23652;'</span>,<span style="color: #98be65;">'&#20303;&#23478;&#29992;'</span>,<span style="color: #98be65;">'&#25991;&#25945;&#21312;'</span>],
<span class="linenr"> 7: </span>[<span style="color: #98be65;">'&#23433;&#21335;&#21312;'</span>,<span style="color: #da8548; font-weight: bold;">350</span>,<span style="color: #da8548; font-weight: bold;">32.00</span>,<span style="color: #da8548; font-weight: bold;">11</span>,<span style="color: #98be65;">'&#36879;&#22825;&#21405;'</span>,<span style="color: #da8548; font-weight: bold;">57</span>,<span style="color: #98be65;">'&#20840;/&#20108;&#23652;'</span>,<span style="color: #98be65;">'&#20303;&#23478;&#29992;'</span>,<span style="color: #98be65;">'&#36786;&#26989;&#21312;'</span>],
<span class="linenr"> 8: </span>[<span style="color: #98be65;">'&#27512;&#20161;&#21312;'</span>,<span style="color: #da8548; font-weight: bold;">950</span>,<span style="color: #da8548; font-weight: bold;">22.9</span>,<span style="color: #da8548; font-weight: bold;">41.49</span>,<span style="color: #98be65;">'&#20303;&#23429;&#22823;&#27155;(11&#23652;&#21547;&#20197;&#19978;&#26377;&#38651;&#26799;)'</span>,<span style="color: #da8548; font-weight: bold;">29</span>,<span style="color: #98be65;">'&#22235;&#23652;/&#20108;&#21313;&#23652;'</span>,<span style="color: #98be65;">'&#20303;&#23478;&#29992;'</span>,<span style="color: #98be65;">'&#20445;&#35703;&#21312;'</span>],
<span class="linenr"> 9: </span>[<span style="color: #98be65;">'&#26481;&#21312;'</span>,<span style="color: #da8548; font-weight: bold;">390</span>,<span style="color: #da8548; font-weight: bold;">24.7</span>,<span style="color: #da8548; font-weight: bold;">56.38</span>,<span style="color: #98be65;">'&#20303;&#23429;&#22823;&#27155;(11&#23652;&#21547;&#20197;&#19978;&#26377;&#38651;&#26799;)'</span>,<span style="color: #da8548; font-weight: bold;">27</span>,<span style="color: #98be65;">'&#21313;&#19977;&#23652;/&#21313;&#22235;&#23652;'</span>,<span style="color: #98be65;">'&#20303;&#21830;&#29992;'</span>,<span style="color: #98be65;">'&#34892;&#25919;&#21312;'</span>],
<span class="linenr">10: </span>[<span style="color: #98be65;">'&#26032;&#21270;&#21312;'</span>,<span style="color: #da8548; font-weight: bold;">482</span>,<span style="color: #da8548; font-weight: bold;">15.3</span>,<span style="color: #da8548; font-weight: bold;">31.59</span>,<span style="color: #98be65;">'&#20844;&#23507;(5&#27155;&#21547;&#20197;&#19979;&#28961;&#38651;&#26799;)'</span>,<span style="color: #da8548; font-weight: bold;">42</span>,<span style="color: #98be65;">'&#19977;&#23652;/&#20116;&#23652;'</span>,<span style="color: #98be65;">'&#20303;&#23478;&#29992;'</span>,<span style="color: #98be65;">'&#20489;&#24235;&#21312;'</span>]])
<span class="linenr">11: </span>df.<span style="color: #dcaeea;">columns</span> = [<span style="color: #98be65;">'&#22320;&#27573;'</span>, <span style="color: #98be65;">'&#32317;&#20729;'</span>, <span style="color: #98be65;">'&#21934;&#20729;'</span>, <span style="color: #98be65;">'&#32317;&#38754;&#31309;'</span>, <span style="color: #98be65;">'&#22411;&#24907;'</span>, <span style="color: #98be65;">'&#23627;&#40801;'</span>, <span style="color: #98be65;">'&#27155;&#21029;'</span>, <span style="color: #98be65;">'&#29992;&#36884;'</span>, <span style="color: #98be65;">'&#22320;&#21312;&#21029;'</span>]
<span class="linenr">12: </span><span style="color: #c678dd;">print</span>(df)
<span class="linenr">13: </span>
<span class="linenr">14: </span><span style="color: #dcaeea;">mmScaler</span> = MinMaxScaler()
<span class="linenr">15: </span><span style="color: #c678dd;">print</span>(<span style="color: #98be65;">'===Normalization&#24460;&#30340;&#36039;&#26009;==='</span>)
<span class="linenr">16: </span>df[[<span style="color: #98be65;">'&#32317;&#20729;'</span>, <span style="color: #98be65;">'&#21934;&#20729;'</span>]] = mmScaler.fit_transform(df[[<span style="color: #98be65;">'&#32317;&#20729;'</span>, <span style="color: #98be65;">'&#21934;&#20729;'</span>]])
<span class="linenr">17: </span><span style="color: #c678dd;">print</span>(df[[<span style="color: #98be65;">'&#32317;&#20729;'</span>, <span style="color: #98be65;">'&#21934;&#20729;'</span>]])
<span class="linenr">18: </span>
<span class="linenr">19: </span><span style="color: #5B6268;"># </span><span style="color: #5B6268;">&#23559;&#25976;&#25818;&#36996;&#21407;&#21040;&#21407;&#22987;&#31684;&#22285;</span>
<span class="linenr">20: </span><span style="color: #c678dd;">print</span>(<span style="color: #98be65;">'===&#36996;&#21407;&#24460;&#30340;&#36039;&#26009;==='</span>)
<span class="linenr">21: </span>df[[<span style="color: #98be65;">'&#32317;&#20729;'</span>, <span style="color: #98be65;">'&#21934;&#20729;'</span>]] = mmScaler.inverse_transform(df[[<span style="color: #98be65;">'&#32317;&#20729;'</span>, <span style="color: #98be65;">'&#21934;&#20729;'</span>]])
<span class="linenr">22: </span><span style="color: #c678dd;">print</span>(df[[<span style="color: #98be65;">'&#32317;&#20729;'</span>, <span style="color: #98be65;">'&#21934;&#20729;'</span>]])
</pre>
</div>

<pre class="example" id="org9ad9870">
    地段   總價    單價    總面積               型態  屋齡       樓別   用途  地區別
0   東區  150  25.3  45.49    華廈(10層含以下有電梯)  30    四層/九層  住家用  文教區
1   北區  321  16.8  78.66  住宅大樓(11層含以上有電梯)  32  十三層/十四層  商業用  行政區
2   東區  900  29.2  30.87    華廈(10層含以下有電梯)  28    三層/九層  住商用  倉庫區
3  新市區  460  13.4  34.35    華廈(10層含以下有電梯)  43    五層/五層  住家用  文教區
4  安南區  350  32.0  11.00              透天厝  57     全/二層  住家用  農業區
5  歸仁區  950  22.9  41.49  住宅大樓(11層含以上有電梯)  29   四層/二十層  住家用  保護區
6   東區  390  24.7  56.38  住宅大樓(11層含以上有電梯)  27  十三層/十四層  住商用  行政區
7  新化區  482  15.3  31.59     公寓(5樓含以下無電梯)  42    三層/五層  住家用  倉庫區
===Normalization後的資料===
        總價        單價
0  0.00000  0.639785
1  0.21375  0.182796
2  0.93750  0.849462
3  0.38750  0.000000
4  0.25000  1.000000
5  1.00000  0.510753
6  0.30000  0.607527
7  0.41500  0.102151
===還原後的資料===
      總價    單價
0  150.0  25.3
1  321.0  16.8
2  900.0  29.2
3  460.0  13.4
4  350.0  32.0
5  950.0  22.9
6  390.0  24.7
7  482.0  15.3
</pre>
</div>
</div>
<div id="outline-container-org4a03bfc" class="outline-3">
<h3 id="org4a03bfc"><span class="section-number-3">3.2.</span> 標準化(Standardization)</h3>
<div class="outline-text-3" id="text-3-2">
<p>
雖說常態化簡單實用，但對許多機器學習演算法來說(特別是梯度下降法的最佳化)，標準化則更為實際，我們可令標準化後的特徵值其平均數為 0、標準差為 1，這樣一來，特徵值會滿足常態分佈，進而使演算法對於離群值不那麼敏感。標準化的公式如下：<br />
\[x_{std}^i = \frac{x^i-\mu_x}{\sigma_x}\]<br />
若以 scikit-learn 套件來完成實作，其程式碼如下：<br />
</p>
<div class="org-src-container">
<pre class="src src-python"><span class="linenr">1: </span><span style="color: #51afef;">from</span> sklearn.preprocessing <span style="color: #51afef;">import</span> StandardScaler
<span class="linenr">2: </span><span style="color: #dcaeea;">sdScaler</span> = StandardScaler()
<span class="linenr">3: </span>df[[<span style="color: #98be65;">'&#32317;&#20729;'</span>, <span style="color: #98be65;">'&#21934;&#20729;'</span>]] = sdScaler.fit_transform(df[[<span style="color: #98be65;">'&#32317;&#20729;'</span>, <span style="color: #98be65;">'&#21934;&#20729;'</span>]])
<span class="linenr">4: </span><span style="color: #c678dd;">print</span>(<span style="color: #98be65;">'===&#27161;&#28310;&#21270;&#24460;&#30340;&#36039;&#26009;==='</span>)
<span class="linenr">5: </span><span style="color: #c678dd;">print</span>(df[[<span style="color: #98be65;">'&#32317;&#20729;'</span>, <span style="color: #98be65;">'&#21934;&#20729;'</span>]])
<span class="linenr">6: </span>
<span class="linenr">7: </span>df[[<span style="color: #98be65;">'&#32317;&#20729;'</span>, <span style="color: #98be65;">'&#21934;&#20729;'</span>]] = sdScaler.inverse_transform(df[[<span style="color: #98be65;">'&#32317;&#20729;'</span>, <span style="color: #98be65;">'&#21934;&#20729;'</span>]])
<span class="linenr">8: </span><span style="color: #c678dd;">print</span>(<span style="color: #98be65;">'===&#36996;&#21407;&#24460;&#30340;&#36039;&#26009;==='</span>)
<span class="linenr">9: </span><span style="color: #c678dd;">print</span>(df[[<span style="color: #98be65;">'&#32317;&#20729;'</span>, <span style="color: #98be65;">'&#21934;&#20729;'</span>]])
</pre>
</div>

<pre class="example" id="org19dd15d">
===標準化後的資料===
         總價        單價
0 -1.331969  0.454115
1 -0.681904 -0.900263
2  1.519196  1.075535
3 -0.153488 -1.442014
4 -0.571659  1.521683
5  1.709274  0.071702
6 -0.419596  0.358512
7 -0.069854 -1.139270
===還原後的資料===
      總價    單價
0  150.0  25.3
1  321.0  16.8
2  900.0  29.2
3  460.0  13.4
4  350.0  32.0
5  950.0  22.9
6  390.0  24.7
7  482.0  15.3
</pre>
</div>
</div>
</div>
<div id="outline-container-orgd8a3524" class="outline-2">
<h2 id="orgd8a3524"><span class="section-number-2">4.</span> 資料擴增</h2>
<div class="outline-text-2" id="text-4">
</div>
<div id="outline-container-org3df4ae2" class="outline-3">
<h3 id="org3df4ae2"><span class="section-number-3">4.1.</span> 範例</h3>
<div class="outline-text-3" id="text-4-1">
<p>
安裝opencv<br />
</p>
<div class="org-src-container">
<pre class="src src-shell"><span class="linenr">1: </span>pip3 install opencv-python
</pre>
</div>
<p>
資料夾位置 ~/Downloads<br />
資料夾架構<br />
</p>
<div class="org-src-container">
<pre class="src src-shell"><span class="linenr">1: </span>tree ~/Downloads/aug -d
</pre>
</div>

<pre class="example">
/Users/letranger/Downloads/aug
├── augImages
│   ├── cats
│   └── dogs
└── images
    ├── cats
    └── dogs

7 directories
</pre>


<div class="org-src-container">
<pre class="src src-python"><span style="color: #51afef;">import</span> cv2
<span style="color: #51afef;">import</span> os
<span style="color: #51afef;">import</span> numpy <span style="color: #51afef;">as</span> np

<span style="color: #51afef;">def</span> <span style="color: #c678dd;">augment_image</span>(image):
    <span style="color: #83898d;">"""&#23565;&#36664;&#20837;&#22294;&#20687;&#36914;&#34892;&#25976;&#25818;&#22686;&#24375;&#20006;&#36820;&#22238;&#22686;&#24375;&#24460;&#30340;&#22294;&#20687;&#21015;&#34920;"""</span>
    <span style="color: #dcaeea;">augmented_images</span> = []

    <span style="color: #5B6268;"># </span><span style="color: #5B6268;">&#21407;&#22294;</span>
    augmented_images.append(image)

    <span style="color: #5B6268;"># </span><span style="color: #5B6268;">&#32763;&#36681;&#22294;&#20687;</span>
    <span style="color: #dcaeea;">flip1</span> = cv2.flip(image, <span style="color: #da8548; font-weight: bold;">0</span>)  <span style="color: #5B6268;"># </span><span style="color: #5B6268;">&#22402;&#30452;&#32763;&#36681;</span>
    <span style="color: #dcaeea;">flip2</span> = cv2.flip(image, <span style="color: #da8548; font-weight: bold;">1</span>)  <span style="color: #5B6268;"># </span><span style="color: #5B6268;">&#27700;&#24179;&#32763;&#36681;</span>
    <span style="color: #dcaeea;">flip3</span> = cv2.flip(image, -<span style="color: #da8548; font-weight: bold;">1</span>) <span style="color: #5B6268;"># </span><span style="color: #5B6268;">&#22402;&#30452;&#21644;&#27700;&#24179;&#32763;&#36681;</span>
    augmented_images.extend([flip1, flip2, flip3])

    <span style="color: #5B6268;"># </span><span style="color: #5B6268;">&#26059;&#36681;&#22294;&#20687;</span>
    <span style="color: #51afef;">for</span> angle <span style="color: #51afef;">in</span> [<span style="color: #da8548; font-weight: bold;">90</span>, <span style="color: #da8548; font-weight: bold;">180</span>, <span style="color: #da8548; font-weight: bold;">270</span>]:
        <span style="color: #dcaeea;">M</span> = cv2.getRotationMatrix2D((image.shape[<span style="color: #da8548; font-weight: bold;">1</span>] // <span style="color: #da8548; font-weight: bold;">2</span>, image.shape[<span style="color: #da8548; font-weight: bold;">0</span>] // <span style="color: #da8548; font-weight: bold;">2</span>), angle, <span style="color: #da8548; font-weight: bold;">1</span>)
        <span style="color: #dcaeea;">rotated</span> = cv2.warpAffine(image, M, (image.shape[<span style="color: #da8548; font-weight: bold;">1</span>], image.shape[<span style="color: #da8548; font-weight: bold;">0</span>]))
        augmented_images.append(rotated)

    <span style="color: #5B6268;"># </span><span style="color: #5B6268;">&#32302;&#25918;&#22294;&#20687;</span>
    <span style="color: #51afef;">for</span> scale <span style="color: #51afef;">in</span> [<span style="color: #da8548; font-weight: bold;">0.9</span>, <span style="color: #da8548; font-weight: bold;">1.1</span>]:
        <span style="color: #dcaeea;">scaled</span> = cv2.resize(image, <span style="color: #a9a1e1;">None</span>, fx=scale, fy=scale)
        augmented_images.append(scaled)

    <span style="color: #51afef;">return</span> augmented_images

<span style="color: #51afef;">def</span> <span style="color: #c678dd;">process_directory</span>(input_dir, output_dir):
    <span style="color: #83898d;">"""&#34389;&#29702;&#36664;&#20837;&#30446;&#37636;&#20013;&#30340;&#25152;&#26377;&#22294;&#20687;&#65292;&#20006;&#23559;&#22686;&#24375;&#24460;&#30340;&#22294;&#20687;&#20445;&#23384;&#21040;&#36664;&#20986;&#30446;&#37636;"""</span>
    <span style="color: #51afef;">if</span> <span style="color: #51afef;">not</span> os.path.exists(output_dir):
        os.makedirs(output_dir)

    <span style="color: #dcaeea;">categories</span> = [<span style="color: #98be65;">'dogs'</span>, <span style="color: #98be65;">'cats'</span>]
    <span style="color: #51afef;">for</span> category <span style="color: #51afef;">in</span> categories:
        <span style="color: #dcaeea;">category_input_dir</span> = os.path.join(input_dir, category)
        <span style="color: #dcaeea;">category_output_dir</span> = os.path.join(output_dir, category)

        <span style="color: #51afef;">for</span> filename <span style="color: #51afef;">in</span> os.listdir(category_input_dir):
            <span style="color: #dcaeea;">image_path</span> = os.path.join(category_input_dir, filename)
            <span style="color: #dcaeea;">image</span> = cv2.imread(image_path)
            <span style="color: #dcaeea;">augmented_images</span> = augment_image(image)

            <span style="color: #51afef;">for</span> i, augmented_image <span style="color: #51afef;">in</span> <span style="color: #c678dd;">enumerate</span>(augmented_images):
                <span style="color: #dcaeea;">output_filename</span> = f<span style="color: #98be65;">"</span>{os.path.splitext(filename)[0]}<span style="color: #98be65;">_aug_</span>{i}<span style="color: #98be65;">.jpg"</span>
                <span style="color: #dcaeea;">output_path</span> = os.path.join(category_output_dir, output_filename)
                cv2.imwrite(output_path, augmented_image)

<span style="color: #5B6268;"># </span><span style="color: #5B6268;">&#36664;&#20837;&#21644;&#36664;&#20986;&#30446;&#37636;</span>
<span style="color: #dcaeea;">input_directory</span> = <span style="color: #98be65;">'/Users/letranger/Downloads/aug/images'</span>
<span style="color: #dcaeea;">output_directory</span> = <span style="color: #98be65;">'/Users/letranger/Downloads/aug/augImages'</span>

<span style="color: #5B6268;"># </span><span style="color: #5B6268;">&#34389;&#29702;&#22294;&#20687;</span>
process_directory(input_directory, output_directory)
</pre>
</div>
</div>
</div>
<div id="outline-container-org0d3d852" class="outline-3">
<h3 id="org0d3d852"><span class="section-number-3">4.2.</span> 其他擴增方法</h3>
<div class="outline-text-3" id="text-4-2">
<p>
其他資料擴增方式還有:濾波、銳化、去噪、旋轉、縮放、裁剪和增加人工噪聲&#x2026;.，至於資料擴增對於模型有何助益請<a href="https://blog.toright.com/posts/7144/keras-tutorial-cnn-data-augmentation-training">參閱這篇</a>。其他資料擴增方式請看:<br />
</p>
<ul class="org-ul">
<li><a href="https://cynthiachuang.github.io/Augmentor-Image-Augmentation-Library-in-Python/">Augmentor：影像資料增強工具庫</a><br /></li>
<li><a href="https://chtseng.wordpress.com/2017/11/11/data-augmentation-%E8%B3%87%E6%96%99%E5%A2%9E%E5%BC%B7/">Data Augmentation 資料增強</a><br /></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org0566b88" class="outline-2">
<h2 id="org0566b88"><span class="section-number-2">5.</span> 資料集與資料分割</h2>
<div class="outline-text-2" id="text-5">
</div>
<div id="outline-container-orgf590d07" class="outline-3">
<h3 id="orgf590d07"><span class="section-number-3">5.1.</span> 常用資料集</h3>
<div class="outline-text-3" id="text-5-1">
<p>
當你使用 Python 學習人工智慧（AI）和機器學習（ML）時，以下是一些常用的資料集及其簡單介紹：<br />
</p>
</div>
<div id="outline-container-org45f1790" class="outline-4">
<h4 id="org45f1790"><span class="section-number-4">5.1.1.</span> MNIST</h4>
<div class="outline-text-4" id="text-5-1-1">
<p>
簡介：MNIST（Modified National Institute of Standards and Technology database）是一個大型手寫數字資料集，包含 0 到 9 的手寫數字圖像。<br />
</p>
<ul class="org-ul">
<li>用途：常用於圖像分類和計算機視覺的入門練習。<br /></li>
<li>特徵：包含 60,000 張訓練圖像和 10,000 張測試圖像，每張圖像大小為 28x28 像素。<br /></li>
<li>來源：可以從 tensorflow 或 keras 中直接獲取。<br /></li>
</ul>
<div class="org-src-container">
<pre class="src src-python"><span class="linenr">1: </span><span style="color: #51afef;">from</span> tensorflow.keras.datasets <span style="color: #51afef;">import</span> mnist
<span class="linenr">2: </span>(x_train, y_train), (<span style="color: #dcaeea;">x_test</span>, <span style="color: #dcaeea;">y_test</span>) = mnist.load_data()
</pre>
</div>
</div>
</div>
<div id="outline-container-orgab6cc03" class="outline-4">
<h4 id="orgab6cc03"><span class="section-number-4">5.1.2.</span> Iris</h4>
<div class="outline-text-4" id="text-5-1-2">
<ul class="org-ul">
<li>簡介：Iris 資料集包含 3 種鰹魚花（Setosa、Versicolour 和 Virginica）的 150 個樣本，每個樣本有 4 個特徵（花萼長度、花萼寬度、花瓣長度、花瓣寬度）。<br /></li>
<li>用途：常用於分類和聚類算法的入門練習。<br /></li>
<li>特徵：每個樣本包含 4 個特徵和 1 個標籤。<br /></li>
<li>來源：可以從 sklearn 中直接獲取。<br /></li>
</ul>
<div class="org-src-container">
<pre class="src src-python"><span class="linenr">1: </span><span style="color: #51afef;">from</span> sklearn.datasets <span style="color: #51afef;">import</span> load_iris
<span class="linenr">2: </span><span style="color: #dcaeea;">iris</span> = load_iris()
<span class="linenr">3: </span><span style="color: #dcaeea;">X</span>, <span style="color: #dcaeea;">y</span> = iris.data, iris.target
</pre>
</div>
</div>
</div>
<div id="outline-container-org93ca5bc" class="outline-4">
<h4 id="org93ca5bc"><span class="section-number-4">5.1.3.</span> Boston 房價</h4>
<div class="outline-text-4" id="text-5-1-3">
<ul class="org-ul">
<li>簡介：Boston 房價資料集包含 506 個房屋的特徵和價格信息，用於回歸問題。<br /></li>
<li>用途：常用於回歸算法的入門練習。<br /></li>
<li>特徵：每個樣本包含 13 個特徵，如犯罪率、房間數、房產稅等。<br /></li>
<li>來源：可以從 sklearn 中直接獲取。<br /></li>
</ul>
<div class="org-src-container">
<pre class="src src-python"><span class="linenr">1: </span><span style="color: #51afef;">import</span> matplotlib.pyplot <span style="color: #51afef;">as</span> plt
<span class="linenr">2: </span><span style="color: #51afef;">from</span> tensorflow.keras.datasets <span style="color: #51afef;">import</span> boston_housing
<span class="linenr">3: </span>
<span class="linenr">4: </span>(train_x, train_y), (<span style="color: #dcaeea;">test_x</span>, <span style="color: #dcaeea;">test_y</span>) = boston_housing.load_data()
</pre>
</div>
</div>
</div>
<div id="outline-container-orga4b7f81" class="outline-4">
<h4 id="orga4b7f81"><span class="section-number-4">5.1.4.</span> CIFAR-10</h4>
<div class="outline-text-4" id="text-5-1-4">
<ul class="org-ul">
<li>簡介：CIFAR-10 是一個影像資料集，包含 10 個類別的 60,000 張彩色圖片，每個類別有 6,000 張圖片。<br /></li>
<li>用途：常用於圖像分類和深度學習的入門練習。<br /></li>
<li>特徵：每張圖像大小為 32x32 像素。<br /></li>
<li>來源：可以從 tensorflow 或 keras 中直接獲取。<br /></li>
</ul>
<div class="org-src-container">
<pre class="src src-python"><span class="linenr">1: </span><span style="color: #51afef;">from</span> tensorflow.keras.datasets <span style="color: #51afef;">import</span> cifar10
<span class="linenr">2: </span>(x_train, y_train), (<span style="color: #dcaeea;">x_test</span>, <span style="color: #dcaeea;">y_test</span>) = cifar10.load_data()
</pre>
</div>
</div>
</div>
<div id="outline-container-org2501125" class="outline-4">
<h4 id="org2501125"><span class="section-number-4">5.1.5.</span> Wine</h4>
<div class="outline-text-4" id="text-5-1-5">
<ul class="org-ul">
<li>簡介：Wine 資料集包含 178 個樣本，記錄了 3 種不同葡萄酒的 13 個化學成分。<br /></li>
<li>用途：常用於分類問題。<br /></li>
<li>特徵：每個樣本包含 13 個特徵和 1 個標籤。<br /></li>
<li>來源：可以從 sklearn 中直接獲取。<br /></li>
</ul>
<div class="org-src-container">
<pre class="src src-python"><span class="linenr">1: </span><span style="color: #51afef;">from</span> sklearn.datasets <span style="color: #51afef;">import</span> load_wine
<span class="linenr">2: </span><span style="color: #dcaeea;">wine</span> = load_wine()
<span class="linenr">3: </span><span style="color: #dcaeea;">X</span>, <span style="color: #dcaeea;">y</span> = wine.data, wine.target
</pre>
</div>
</div>
</div>
<div id="outline-container-orge913c21" class="outline-4">
<h4 id="orge913c21"><span class="section-number-4">5.1.6.</span> Breast Cancer Wisconsin</h4>
<div class="outline-text-4" id="text-5-1-6">
<ul class="org-ul">
<li>簡介：Breast Cancer Wisconsin 資料集包含 569 個乳腺癌樣本的特徵，目的是預測腫瘤是良性還是惡性。<br /></li>
<li>用途：常用於二元分類問題。<br /></li>
<li>特徵：每個樣本包含 30 個特徵。<br /></li>
<li>來源：可以從 sklearn 中直接獲取。<br /></li>
</ul>
<div class="org-src-container">
<pre class="src src-python"><span class="linenr">1: </span><span style="color: #51afef;">from</span> sklearn.datasets <span style="color: #51afef;">import</span> load_breast_cancer
<span class="linenr">2: </span><span style="color: #dcaeea;">breast_cancer</span> = load_breast_cancer()
<span class="linenr">3: </span><span style="color: #dcaeea;">X</span>, <span style="color: #dcaeea;">y</span> = breast_cancer.data, breast_cancer.target
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org636831a" class="outline-3">
<h3 id="org636831a"><span class="section-number-3">5.2.</span> 資料分割</h3>
<div class="outline-text-3" id="text-5-2">

<div id="orge6f95ba" class="figure">
<p><img src="images/datapreprocessing.png" alt="datapreprocessing.png" /><br />
</p>
</div>
</div>
<div id="outline-container-orgf959fff" class="outline-4">
<h4 id="orgf959fff"><span class="section-number-4">5.2.1.</span> 為什麼要分割資料</h4>
<div class="outline-text-4" id="text-5-2-1">
<ul class="org-ul">
<li>訓練集（training): 舉例來說就是上課學習。主要用在訓練階段，用於模型擬合，直接參與了模型參數調整的過程<sup><a id="fnr.2" class="footref" href="#fn.2" role="doc-backlink">2</a></sup>。<br /></li>
<li>驗證集（validation）: 舉例來說就是模擬考，你會根據模擬考的成績繼續學習、或調整學習方式重新學習。在訓練過程中，用於評估模型的初步能力與超參數調整的依據。不過驗證集是非必需的，不像訓練集和測試集。如果不需要調整超參數，就可以不使用驗證集<sup><a id="fnr.2.100" class="footref" href="#fn.2" role="doc-backlink">2</a></sup>。<br /></li>
<li>測試集（test）就像是學測，用來評估你最終的學習結果。用來評估模型最終的泛化能力。為了能評估模型真正的能力，測試集不應該為參數調整、選擇特徵等依據<sup><a id="fnr.2.100" class="footref" href="#fn.2" role="doc-backlink">2</a></sup>。<br /></li>
</ul>
<p>
使用學測來比喻，是因為測試集不應該做為參數調整、選擇特徵等依據。這些選擇與調整可以想像成學習方式的調整，但學測已經考完，你不能時光倒轉回到最初調整學習方式<sup><a id="fnr.2.100" class="footref" href="#fn.2" role="doc-backlink">2</a></sup>。<br />
</p>
</div>
</div>
<div id="outline-container-orgd75f08c" class="outline-4">
<h4 id="orgd75f08c"><span class="section-number-4">5.2.2.</span> 資料分割實作</h4>
<div class="outline-text-4" id="text-5-2-2">
<p>
訓練集與測試集的分割可以自行以Python進行分割，也可以直接呼叫函式進行分割<br />
</p>
</div>
<div id="outline-container-orga771520" class="outline-5">
<h5 id="orga771520"><span class="section-number-5">5.2.2.1.</span> 手動分割</h5>
<div class="outline-text-5" id="text-5-2-2-1">
<div class="org-src-container">
<pre class="src src-python"><span class="linenr"> 1: </span><span style="color: #51afef;">import</span> pandas <span style="color: #51afef;">as</span> pd
<span class="linenr"> 2: </span><span style="color: #51afef;">import</span> numpy <span style="color: #51afef;">as</span> np
<span class="linenr"> 3: </span><span style="color: #51afef;">import</span> random
<span class="linenr"> 4: </span>
<span class="linenr"> 5: </span><span style="color: #dcaeea;">df_wine</span> = pd.read_csv(<span style="color: #98be65;">'https://archive.ics.uci.edu/'</span>
<span class="linenr"> 6: </span>                      <span style="color: #98be65;">'ml/machine-learning-databases/wine/wine.data'</span>,
<span class="linenr"> 7: </span>                      header=<span style="color: #a9a1e1;">None</span>)
<span class="linenr"> 8: </span>
<span class="linenr"> 9: </span>df_wine.<span style="color: #dcaeea;">columns</span> = [<span style="color: #98be65;">'Class label'</span>, <span style="color: #98be65;">'Alcohol'</span>, <span style="color: #98be65;">'Malic acid'</span>, <span style="color: #98be65;">'Ash'</span>,
<span class="linenr">10: </span>                   <span style="color: #98be65;">'Alcalinity of ash'</span>, <span style="color: #98be65;">'Magnesium'</span>, <span style="color: #98be65;">'Total phenols'</span>,
<span class="linenr">11: </span>                   <span style="color: #98be65;">'Flavanoids'</span>, <span style="color: #98be65;">'Nonflavanoid phenols'</span>, <span style="color: #98be65;">'Proanthocyanins'</span>,
<span class="linenr">12: </span>                   <span style="color: #98be65;">'Color intensity'</span>, <span style="color: #98be65;">'Hue'</span>, <span style="color: #98be65;">'OD280/OD315 of diluted wines'</span>,
<span class="linenr">13: </span>                   <span style="color: #98be65;">'Proline'</span>]
<span class="linenr">14: </span>
<span class="linenr">15: </span><span style="color: #dcaeea;">train_len</span> = <span style="color: #c678dd;">int</span>(<span style="color: #c678dd;">len</span>(df_wine) * <span style="color: #da8548; font-weight: bold;">0.7</span>)
<span class="linenr">16: </span>
<span class="linenr">17: </span><span style="color: #5B6268;"># </span><span style="color: #5B6268;">&#25171;&#20098;&#36039;&#26009;&#38598;&#38918;&#24207;</span>
<span class="linenr">18: </span><span style="color: #dcaeea;">idx</span> = <span style="color: #c678dd;">list</span>(df_wine.index)
<span class="linenr">19: </span>random.shuffle(idx)
<span class="linenr">20: </span>
<span class="linenr">21: </span><span style="color: #5B6268;"># </span><span style="color: #5B6268;">&#20998;&#21106;&#36039;&#26009;&#38598;</span>
<span class="linenr">22: </span><span style="color: #dcaeea;">TrainSet</span> = df_wine.loc[idx[:train_len]]
<span class="linenr">23: </span><span style="color: #dcaeea;">TestSet</span> = df_wine.loc[idx[train_len:]]
<span class="linenr">24: </span><span style="color: #c678dd;">print</span>(<span style="color: #c678dd;">len</span>(TrainSet))
<span class="linenr">25: </span><span style="color: #c678dd;">print</span>(<span style="color: #c678dd;">len</span>(TestSet))
<span class="linenr">26: </span><span style="color: #dcaeea;">X_train</span>, <span style="color: #dcaeea;">y_train</span> = TrainSet.iloc[:, <span style="color: #da8548; font-weight: bold;">1</span>:].values, TrainSet.iloc[:, <span style="color: #da8548; font-weight: bold;">0</span>].values
<span class="linenr">27: </span><span style="color: #dcaeea;">X_test</span>, <span style="color: #dcaeea;">y_test</span> = TestSet.iloc[:, <span style="color: #da8548; font-weight: bold;">1</span>:].values, TestSet.iloc[:, <span style="color: #da8548; font-weight: bold;">0</span>].values
<span class="linenr">28: </span>
<span class="linenr">29: </span><span style="color: #c678dd;">print</span>(<span style="color: #98be65;">'==========&#35347;&#32244;&#38598;=========='</span>)
<span class="linenr">30: </span><span style="color: #c678dd;">print</span>(X_train[:<span style="color: #da8548; font-weight: bold;">2</span>])
<span class="linenr">31: </span><span style="color: #c678dd;">print</span>(y_train[:<span style="color: #da8548; font-weight: bold;">2</span>])
<span class="linenr">32: </span><span style="color: #c678dd;">print</span>(<span style="color: #98be65;">'==========&#28204;&#35430;&#38598;=========='</span>)
<span class="linenr">33: </span><span style="color: #c678dd;">print</span>(X_test[:<span style="color: #da8548; font-weight: bold;">2</span>])
<span class="linenr">34: </span><span style="color: #c678dd;">print</span>(y_test[:<span style="color: #da8548; font-weight: bold;">2</span>])
</pre>
</div>

<pre class="example" id="orgd9df51d">
124
54
==========訓練集==========
[[1.229e+01 2.830e+00 2.220e+00 1.800e+01 8.800e+01 2.450e+00 2.250e+00
  2.500e-01 1.990e+00 2.150e+00 1.150e+00 3.300e+00 2.900e+02]
 [1.340e+01 4.600e+00 2.860e+00 2.500e+01 1.120e+02 1.980e+00 9.600e-01
  2.700e-01 1.110e+00 8.500e+00 6.700e-01 1.920e+00 6.300e+02]]
[2 3]
==========測試集==========
[[1.394e+01 1.730e+00 2.270e+00 1.740e+01 1.080e+02 2.880e+00 3.540e+00
  3.200e-01 2.080e+00 8.900e+00 1.120e+00 3.100e+00 1.260e+03]
 [1.402e+01 1.680e+00 2.210e+00 1.600e+01 9.600e+01 2.650e+00 2.330e+00
  2.600e-01 1.980e+00 4.700e+00 1.040e+00 3.590e+00 1.035e+03]]
[1 1]
</pre>
</div>
</div>
<div id="outline-container-orga46c166" class="outline-5">
<h5 id="orga46c166"><span class="section-number-5">5.2.2.2.</span> 呼叫scikit learn的function</h5>
<div class="outline-text-5" id="text-5-2-2-2">
<div class="org-src-container">
<pre class="src src-python"><span class="linenr"> 1: </span><span style="color: #51afef;">import</span> pandas <span style="color: #51afef;">as</span> pd
<span class="linenr"> 2: </span><span style="color: #51afef;">import</span> numpy <span style="color: #51afef;">as</span> np
<span class="linenr"> 3: </span><span style="color: #51afef;">from</span> sklearn.model_selection <span style="color: #51afef;">import</span> train_test_split
<span class="linenr"> 4: </span>
<span class="linenr"> 5: </span><span style="color: #dcaeea;">df_wine</span> = pd.read_csv(<span style="color: #98be65;">'https://archive.ics.uci.edu/'</span>
<span class="linenr"> 6: </span>                      <span style="color: #98be65;">'ml/machine-learning-databases/wine/wine.data'</span>,
<span class="linenr"> 7: </span>                      header=<span style="color: #a9a1e1;">None</span>)
<span class="linenr"> 8: </span>
<span class="linenr"> 9: </span>df_wine.<span style="color: #dcaeea;">columns</span> = [<span style="color: #98be65;">'Class label'</span>, <span style="color: #98be65;">'Alcohol'</span>, <span style="color: #98be65;">'Malic acid'</span>, <span style="color: #98be65;">'Ash'</span>,
<span class="linenr">10: </span>                   <span style="color: #98be65;">'Alcalinity of ash'</span>, <span style="color: #98be65;">'Magnesium'</span>, <span style="color: #98be65;">'Total phenols'</span>,
<span class="linenr">11: </span>                   <span style="color: #98be65;">'Flavanoids'</span>, <span style="color: #98be65;">'Nonflavanoid phenols'</span>, <span style="color: #98be65;">'Proanthocyanins'</span>,
<span class="linenr">12: </span>                   <span style="color: #98be65;">'Color intensity'</span>, <span style="color: #98be65;">'Hue'</span>, <span style="color: #98be65;">'OD280/OD315 of diluted wines'</span>,
<span class="linenr">13: </span>                   <span style="color: #98be65;">'Proline'</span>]
<span class="linenr">14: </span>
<span class="linenr">15: </span><span style="color: #c678dd;">print</span>(<span style="color: #98be65;">'Class labels'</span>, np.unique(df_wine[<span style="color: #98be65;">'Class label'</span>]))
<span class="linenr">16: </span>
<span class="linenr">17: </span><span style="color: #dcaeea;">X</span>, <span style="color: #dcaeea;">y</span> = df_wine.iloc[:, <span style="color: #da8548; font-weight: bold;">1</span>:].values, df_wine.iloc[:, <span style="color: #da8548; font-weight: bold;">0</span>].values
<span class="linenr">18: </span>
<span class="linenr">19: </span><span style="color: #51afef;">from</span> sklearn.model_selection <span style="color: #51afef;">import</span> train_test_split
<span class="linenr">20: </span><span style="color: #dcaeea;">X_train</span>, <span style="color: #dcaeea;">X_test</span>, <span style="color: #dcaeea;">y_train</span>, <span style="color: #dcaeea;">y_test</span> = train_test_split(X, y,
<span class="linenr">21: </span>                     test_size=<span style="color: #da8548; font-weight: bold;">0.3</span>, random_state=<span style="color: #da8548; font-weight: bold;">0</span>, stratify=y)
<span class="linenr">22: </span>
<span class="linenr">23: </span><span style="color: #c678dd;">print</span>(<span style="color: #c678dd;">len</span>(X_train))
<span class="linenr">24: </span><span style="color: #c678dd;">print</span>(<span style="color: #c678dd;">len</span>(y_test))
<span class="linenr">25: </span>
<span class="linenr">26: </span><span style="color: #c678dd;">print</span>(<span style="color: #98be65;">'==========&#35347;&#32244;&#38598;=========='</span>)
<span class="linenr">27: </span><span style="color: #c678dd;">print</span>(X_train[:<span style="color: #da8548; font-weight: bold;">2</span>])
<span class="linenr">28: </span><span style="color: #c678dd;">print</span>(y_train[:<span style="color: #da8548; font-weight: bold;">2</span>])
<span class="linenr">29: </span><span style="color: #c678dd;">print</span>(<span style="color: #98be65;">'==========&#28204;&#35430;&#38598;=========='</span>)
<span class="linenr">30: </span><span style="color: #c678dd;">print</span>(X_test[:<span style="color: #da8548; font-weight: bold;">2</span>])
<span class="linenr">31: </span><span style="color: #c678dd;">print</span>(y_test[:<span style="color: #da8548; font-weight: bold;">2</span>])
</pre>
</div>

<pre class="example" id="org64eaa1d">
Class labels [1 2 3]
124
54
==========訓練集==========
[[1.362e+01 4.950e+00 2.350e+00 2.000e+01 9.200e+01 2.000e+00 8.000e-01
  4.700e-01 1.020e+00 4.400e+00 9.100e-01 2.050e+00 5.500e+02]
 [1.376e+01 1.530e+00 2.700e+00 1.950e+01 1.320e+02 2.950e+00 2.740e+00
  5.000e-01 1.350e+00 5.400e+00 1.250e+00 3.000e+00 1.235e+03]]
[3 1]
==========測試集==========
[[1.377e+01 1.900e+00 2.680e+00 1.710e+01 1.150e+02 3.000e+00 2.790e+00
  3.900e-01 1.680e+00 6.300e+00 1.130e+00 2.930e+00 1.375e+03]
 [1.217e+01 1.450e+00 2.530e+00 1.900e+01 1.040e+02 1.890e+00 1.750e+00
  4.500e-01 1.030e+00 2.950e+00 1.450e+00 2.230e+00 3.550e+02]]
[1 2]
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-org4dde276" class="outline-2">
<h2 id="org4dde276"><span class="section-number-2">6.</span> 資料間的關係</h2>
<div class="outline-text-2" id="text-6">
<p>
找出特徵值間的差異與相似性是機器學習中非常重要的工作。<br />
</p>
</div>
<div id="outline-container-org3d5f0a3" class="outline-3">
<h3 id="org3d5f0a3"><span class="section-number-3">6.1.</span> 兩點間的距離</h3>
<div class="outline-text-3" id="text-6-1">
<p>
兩種常見的特徵距離計算方式:曼哈頓距離及歐幾里得距離，以一個城市中的兩個地標為例(如圖<a href="#org1e1e51e">2</a>中的兩個黑點)。<br />
</p>


<div id="org1e1e51e" class="figure">
<p><img src="images/資料間的關係/2024-02-02_13-46-36_2024-02-02_13-20-54.png" alt="2024-02-02_13-46-36_2024-02-02_13-20-54.png" width="300" /><br />
</p>
<p><span class="figure-number">Figure 2: </span>城市中的兩個地標</p>
</div>
</div>
<div id="outline-container-orgbaad4f4" class="outline-4">
<h4 id="orgbaad4f4"><span class="section-number-4">6.1.1.</span> 曼哈頓距離（Manhattan distance）</h4>
<div class="outline-text-4" id="text-6-1-1">
<p>
在如圖<a href="#org1e1e51e">2</a>這樣的棋盤式街道的城式中，要由點(1,1)走到(7,7)的最簡單方式是先往上直走到(1,7)，再右轉直走到(7,7)，這便是曼哈頓距離，這段距離為 \(|1-7|+|1-7| \)，公式為<br />
\[ \sum_{i=1}^n|x_i-y_i| \]<br />
</p>
</div>
</div>
<div id="outline-container-org125556d" class="outline-4">
<h4 id="org125556d"><span class="section-number-4">6.1.2.</span> 歐幾里得距離（Euclidian distance）</h4>
<div class="outline-text-4" id="text-6-1-2">

<div id="org1a6ae16" class="figure">
<p><img src="images/資料間的關係/2024-02-02_14-05-00_2024-02-02_14-03-31.png" alt="2024-02-02_14-05-00_2024-02-02_14-03-31.png" width="400" /><br />
</p>
<p><span class="figure-number">Figure 3: </span>Numbus 2000</p>
</div>

<p>
如果我們肯花美金499<sup><a id="fnr.3" class="footref" href="#fn.3" role="doc-backlink">3</a></sup>買到<a href="https://cinereplicas.com/products/harry-potter-nimbus-2000-broom-2019-edition">Nimbus 2000</a>，那我們就能實踐「直線是兩點間最短距離」這個法則，此時圖<a href="#org1e1e51e">2</a>中由點(1,1)到點(7,7)的矩離就變成\( \sqrt{(1-7)^2+(1-7)^2} \)，公式為<br />
\[ \sqrt{\sum_{i=1}^n(x_i-y_i)^2 } \]<br />
</p>
</div>
</div>
</div>
<div id="outline-container-org1a0ed19" class="outline-3">
<h3 id="org1a0ed19"><span class="section-number-3">6.2.</span> 兩個向量間的距離</h3>
<div class="outline-text-3" id="text-6-2">
<p>
以下為三個學生的國文、數學、英文三科成績，哪兩個學生的學業能力較為接近?<br />
</p>
<ul class="org-ul">
<li>James: 80, 90, 70<br /></li>
<li>Ruby: 90, 80, 60<br /></li>
<li>Vanessa: 90, 70, 90<br /></li>
</ul>

<p>
為了回答上述問題，我們可以將學生的各科成績當成vector(如圖<a href="#org49bc155">4</a>)，我們的問題就變成：哪兩個vector更為相似? 三個學生的成績向量分佈如下：<br />
</p>

<div id="org49bc155" class="figure">
<p><img src="images/healthCondition.png" alt="healthCondition.png" width="500" /><br />
</p>
<p><span class="figure-number">Figure 4: </span>三個學生的成績向量</p>
</div>

<p>
如何計算? 有以下三種方式：歐幾里得距離、餘弦相似度、向量內積(如圖<a href="#org8b3b2a3">5</a>)<sup><a id="fnr.4" class="footref" href="#fn.4" role="doc-backlink">4</a></sup>。<br />
</p>

<div id="org8b3b2a3" class="figure">
<p><img src="images/資料間的關係/2024-02-03_17-40-18_2024-02-03_17-39-29.png" alt="2024-02-03_17-40-18_2024-02-03_17-39-29.png" width="500" /><br />
</p>
<p><span class="figure-number">Figure 5: </span>Vector Similarity</p>
</div>
</div>
<div id="outline-container-orga8a2de4" class="outline-4">
<h4 id="orga8a2de4"><span class="section-number-4">6.2.1.</span> 歐幾里得距離</h4>
<div class="outline-text-4" id="text-6-2-1">

<div id="org58b88f3" class="figure">
<p><img src="images/資料間的關係/2024-02-03_17-48-03_2024-02-03_17-47-50.png" alt="2024-02-03_17-48-03_2024-02-03_17-47-50.png" width="300" /><br />
</p>
<p><span class="figure-number">Figure 6: </span>歐幾里得距離</p>
</div>

<p>
多維空間中兩個向量之間的直線距離，距離越近越相似。歐幾里得距離演算法的優點是可以反映向量的絕對距離，適用於需要考慮向量長度的相似性計算。例如推薦系統中，需要根據使用者的歷史行為來推薦相似的商品，這時就需要考慮使用者的歷史行為的數量，而不僅僅是使用者的歷史行為的相似度<sup><a id="fnr.5" class="footref" href="#fn.5" role="doc-backlink">5</a></sup>。<br />
</p>

<ul class="org-ul">
<li>\( a: (a_1, a_2, \dots , a_n)\)<br /></li>
<li>\( b: (b_1, b_2, \dots , b_n)\)<br /></li>
</ul>
<p>
計算兩向量a, b歐幾里得距離的方式為: \( d(a,b) = \sqrt{(a_1-b_1)^2 + (a_2-b_2)^2 + \dots + (a_n-b_n)^2}\)<br />
</p>
</div>
</div>
<div id="outline-container-org198aed7" class="outline-4">
<h4 id="org198aed7"><span class="section-number-4">6.2.2.</span> Cosine Similarity</h4>
<div class="outline-text-4" id="text-6-2-2">

<div id="org34a6b1d" class="figure">
<p><img src="images/資料間的關係/2024-02-03_17-50-17_2024-02-03_17-50-07.png" alt="2024-02-03_17-50-17_2024-02-03_17-50-07.png" width="300" /><br />
</p>
<p><span class="figure-number">Figure 7: </span>餘弦相似度</p>
</div>

<p>
兩個向量的夾角越小越相似，比較兩個向量的餘弦值進行比較，夾角越小，餘弦值越大。餘弦相似度對向量的長度不敏感，只關注向量的方向，因此適用於高維向量的相似性計算。例如語義搜尋和文件分類<sup><a id="fnr.5.100" class="footref" href="#fn.5" role="doc-backlink">5</a></sup>。當兩個向量的方向重合時夾角餘弦取最大值1，當兩個向量的方向完全相反夾角餘弦取最小值-1。<br />
</p>

<ul class="org-ul">
<li>\( a: (a_1, a_2, \dots , a_n)\)<br /></li>
<li>\( b: (b_1, b_2, \dots , b_n)\)<br /></li>
</ul>
<p>
計算兩向量a, b餘弦相似度的方式為: \( sim(a,b) = \frac{a \cdot b}{||a| \cdot |b||} = \frac{ \sum\limits_{i=1}^n a_i \times b_i}{\sqrt{\sum\limits_{i=1}^na_i^2} \times \sqrt{\sum\limits_{i=1}^nb_i^2}} \)<br />
</p>

<p>
有了公式就可以自己用你苦學了半年的Python+高一數學來手刻程式，或是呼叫其他函式庫來計算。<br />
</p>
</div>
<div id="outline-container-org594b99c" class="outline-5">
<h5 id="org594b99c"><span class="section-number-5">6.2.2.1.</span> Python手刻</h5>
<div class="outline-text-5" id="text-6-2-2-1">
<div class="org-src-container">
<pre class="src src-python"><span class="linenr"> 1: </span><span style="color: #51afef;">import</span> math
<span class="linenr"> 2: </span>
<span class="linenr"> 3: </span><span style="color: #51afef;">def</span> <span style="color: #c678dd;">cosine_similarity</span>(v1,v2):
<span class="linenr"> 4: </span>    <span style="color: #dcaeea;">sumxx</span>, <span style="color: #dcaeea;">sumxy</span>, <span style="color: #dcaeea;">sumyy</span> = <span style="color: #da8548; font-weight: bold;">0</span>, <span style="color: #da8548; font-weight: bold;">0</span>, <span style="color: #da8548; font-weight: bold;">0</span>
<span class="linenr"> 5: </span>    <span style="color: #51afef;">for</span> i <span style="color: #51afef;">in</span> <span style="color: #c678dd;">range</span>(<span style="color: #c678dd;">len</span>(v1)):
<span class="linenr"> 6: </span>        <span style="color: #dcaeea;">x</span> = v1[i]; <span style="color: #dcaeea;">y</span> = v2[i]
<span class="linenr"> 7: </span>        <span style="color: #dcaeea;">sumxx</span> += x*x
<span class="linenr"> 8: </span>        <span style="color: #dcaeea;">sumyy</span> += y*y
<span class="linenr"> 9: </span>        <span style="color: #dcaeea;">sumxy</span> += x*y
<span class="linenr">10: </span>    <span style="color: #51afef;">return</span> sumxy/math.sqrt(sumxx*sumyy)
<span class="linenr">11: </span>
<span class="linenr">12: </span><span style="color: #dcaeea;">James</span> = [<span style="color: #da8548; font-weight: bold;">80</span>, <span style="color: #da8548; font-weight: bold;">90</span>, <span style="color: #da8548; font-weight: bold;">70</span>]
<span class="linenr">13: </span><span style="color: #dcaeea;">Ruby</span> = [<span style="color: #da8548; font-weight: bold;">90</span>, <span style="color: #da8548; font-weight: bold;">80</span>, <span style="color: #da8548; font-weight: bold;">60</span>]
<span class="linenr">14: </span><span style="color: #dcaeea;">Vanessa</span> = [<span style="color: #da8548; font-weight: bold;">90</span>, <span style="color: #da8548; font-weight: bold;">70</span>, <span style="color: #da8548; font-weight: bold;">90</span>]
<span class="linenr">15: </span><span style="color: #dcaeea;">JR_sim</span> = cosine_similarity(James, Ruby)
<span class="linenr">16: </span><span style="color: #dcaeea;">RV_sim</span> = cosine_similarity(Ruby, Vanessa)
<span class="linenr">17: </span><span style="color: #dcaeea;">JV_sim</span> = cosine_similarity(James, Vanessa)
<span class="linenr">18: </span>
<span class="linenr">19: </span><span style="color: #c678dd;">print</span>(<span style="color: #98be65;">'James v.s. Ruby:'</span>, JR_sim)
<span class="linenr">20: </span><span style="color: #c678dd;">print</span>(<span style="color: #98be65;">'Ruby v.s. Vanessa:'</span>, RV_sim)
<span class="linenr">21: </span><span style="color: #c678dd;">print</span>(<span style="color: #98be65;">'James v.s. Vanessa:'</span>, JV_sim)
</pre>
</div>

<pre class="example">
James v.s. Ruby: 0.9925966195847843
Ruby v.s. Vanessa: 0.977356154645257
James v.s. Vanessa: 0.978640304032486
</pre>
</div>
</div>
<div id="outline-container-org21409b0" class="outline-5">
<h5 id="org21409b0"><span class="section-number-5">6.2.2.2.</span> Numpy</h5>
<div class="outline-text-5" id="text-6-2-2-2">
<div class="org-src-container">
<pre class="src src-python"><span class="linenr"> 1: </span><span style="color: #51afef;">from</span> numpy <span style="color: #51afef;">import</span> dot
<span class="linenr"> 2: </span><span style="color: #51afef;">from</span> numpy.linalg <span style="color: #51afef;">import</span> norm
<span class="linenr"> 3: </span>
<span class="linenr"> 4: </span><span style="color: #dcaeea;">James</span> = [<span style="color: #da8548; font-weight: bold;">80</span>, <span style="color: #da8548; font-weight: bold;">90</span>, <span style="color: #da8548; font-weight: bold;">70</span>]
<span class="linenr"> 5: </span><span style="color: #dcaeea;">Ruby</span> = [<span style="color: #da8548; font-weight: bold;">90</span>, <span style="color: #da8548; font-weight: bold;">80</span>, <span style="color: #da8548; font-weight: bold;">60</span>]
<span class="linenr"> 6: </span><span style="color: #dcaeea;">Vanessa</span> = [<span style="color: #da8548; font-weight: bold;">90</span>, <span style="color: #da8548; font-weight: bold;">70</span>, <span style="color: #da8548; font-weight: bold;">90</span>]
<span class="linenr"> 7: </span><span style="color: #dcaeea;">JR_sim</span> = dot(James, Ruby)/(norm(James)*norm(Ruby))
<span class="linenr"> 8: </span><span style="color: #dcaeea;">RV_sim</span> = dot(Ruby, Vanessa)/(norm(Ruby)*norm(Vanessa))
<span class="linenr"> 9: </span><span style="color: #dcaeea;">JV_sim</span> = dot(James, Vanessa)/(norm(James)*norm(Vanessa))
<span class="linenr">10: </span>
<span class="linenr">11: </span><span style="color: #c678dd;">print</span>(<span style="color: #98be65;">'James v.s. Ruby:'</span>, JR_sim)
<span class="linenr">12: </span><span style="color: #c678dd;">print</span>(<span style="color: #98be65;">'Ruby v.s. Vanessa:'</span>, RV_sim)
<span class="linenr">13: </span><span style="color: #c678dd;">print</span>(<span style="color: #98be65;">'James v.s. Vanessa:'</span>, JV_sim)
</pre>
</div>

<pre class="example">
James v.s. Ruby: 0.9925966195847841
Ruby v.s. Vanessa: 0.9773561546452569
James v.s. Vanessa: 0.9786403040324858
</pre>
</div>
</div>
<div id="outline-container-org2211590" class="outline-5">
<h5 id="org2211590"><span class="section-number-5">6.2.2.3.</span> Scipy</h5>
<div class="outline-text-5" id="text-6-2-2-3">
<div class="org-src-container">
<pre class="src src-python"><span class="linenr"> 1: </span><span style="color: #51afef;">from</span> scipy <span style="color: #51afef;">import</span> spatial
<span class="linenr"> 2: </span>
<span class="linenr"> 3: </span><span style="color: #dcaeea;">James</span> = [<span style="color: #da8548; font-weight: bold;">80</span>, <span style="color: #da8548; font-weight: bold;">90</span>, <span style="color: #da8548; font-weight: bold;">70</span>]
<span class="linenr"> 4: </span><span style="color: #dcaeea;">Ruby</span> = [<span style="color: #da8548; font-weight: bold;">90</span>, <span style="color: #da8548; font-weight: bold;">80</span>, <span style="color: #da8548; font-weight: bold;">60</span>]
<span class="linenr"> 5: </span><span style="color: #dcaeea;">Vanessa</span> = [<span style="color: #da8548; font-weight: bold;">90</span>, <span style="color: #da8548; font-weight: bold;">70</span>, <span style="color: #da8548; font-weight: bold;">90</span>]
<span class="linenr"> 6: </span><span style="color: #dcaeea;">JR_sim</span> = <span style="color: #da8548; font-weight: bold;">1</span> - spatial.distance.cosine(James, Ruby)
<span class="linenr"> 7: </span><span style="color: #dcaeea;">RV_sim</span> = <span style="color: #da8548; font-weight: bold;">1</span> - spatial.distance.cosine(Ruby, Vanessa)
<span class="linenr"> 8: </span><span style="color: #dcaeea;">JV_sim</span> = <span style="color: #da8548; font-weight: bold;">1</span> - spatial.distance.cosine(James, Vanessa)
<span class="linenr"> 9: </span>
<span class="linenr">10: </span><span style="color: #c678dd;">print</span>(<span style="color: #98be65;">'James v.s. Ruby:'</span>, JR_sim)
<span class="linenr">11: </span><span style="color: #c678dd;">print</span>(<span style="color: #98be65;">'Ruby v.s. Vanessa:'</span>, RV_sim)
<span class="linenr">12: </span><span style="color: #c678dd;">print</span>(<span style="color: #98be65;">'James v.s. Vanessa:'</span>, JV_sim)
</pre>
</div>

<pre class="example">
James v.s. Ruby: 0.9925966195847843
Ruby v.s. Vanessa: 0.977356154645257
James v.s. Vanessa: 0.978640304032486
</pre>
</div>
</div>
</div>
<div id="outline-container-orgb1a81e2" class="outline-4">
<h4 id="orgb1a81e2"><span class="section-number-4">6.2.3.</span> Dot Product</h4>
<div class="outline-text-4" id="text-6-2-3">

<div id="org51699c0" class="figure">
<p><img src="images/資料間的關係/2024-02-03_17-49-28_2024-02-03_17-49-09.png" alt="2024-02-03_17-49-28_2024-02-03_17-49-09.png" width="300" /><br />
</p>
<p><span class="figure-number">Figure 8: </span>向量內積</p>
</div>

<p>
一種計算向量之間相似度的度量演算法，它計算兩個向量之間的點積（內積），所得值越大越與搜尋值相似<sup><a id="fnr.5.100" class="footref" href="#fn.5" role="doc-backlink">5</a></sup>。<br />
</p>

<ul class="org-ul">
<li>\( a: (a_1, a_2, \dots , a_n)\)<br /></li>
<li>\( b: (b_1, b_2, \dots , b_n)\)<br /></li>
</ul>
<p>
計算兩向量a, b內積的方式為: \( a \cdot b =  a_1b_1 + a_2b_2 + \dots + a_nb_n \)<br />
或是<br />
\[ a \cdot b = |a||b| \cos \alpha \]<br />
</p>
</div>
</div>
</div>
<div id="outline-container-orgfefe723" class="outline-3">
<h3 id="orgfefe723"><span class="section-number-3">6.3.</span> 其他應用</h3>
<div class="outline-text-3" id="text-6-3">
<p>
計算向量間的距離不僅可以比較上述以數值呈現的特徵，也能比較看起來並不是數值的特徵，例如：文字。例如，如何比較這幾個單字間的相似性：lion, dog, cat, love, apple, NYC<sup><a id="fnr.6" class="footref" href="#fn.6" role="doc-backlink">6</a></sup>。<br />
</p>

<p>
如圖<a href="#org5ec085c">9</a><sup><a id="fnr.6.100" class="footref" href="#fn.6" role="doc-backlink">6</a></sup>，我們可以由三個角度(animalness, petness, cityness)來賦予每個單字一個數值，那麼就可以利用同樣的方式來比較不同單字間的相似性，這就是自然語言處理的基本原理。<br />
</p>


<div id="org5ec085c" class="figure">
<p><img src="images/資料間的關係/2024-02-03_19-07-07_2024-02-03_19-07-00.png" alt="2024-02-03_19-07-07_2024-02-03_19-07-00.png" width="400" /><br />
</p>
<p><span class="figure-number">Figure 9: </span>不同單字間的相似性</p>
</div>
</div>
</div>
<div id="outline-container-org63fa83f" class="outline-3">
<h3 id="org63fa83f"><span class="section-number-3">6.4.</span> 進階閱讀</h3>
<div class="outline-text-3" id="text-6-4">
<ul class="org-ul">
<li><a href="https://kknews.cc/zh-tw/code/v3laxal.html">python 各類距離公式實現</a><br /></li>
<li><a href="https://www.pinecone.io/learn/vector-similarity/">Vector Similarity Explained</a><br /></li>
</ul>
</div>
</div>
<div id="outline-container-org758f33d" class="outline-3">
<h3 id="org758f33d"><span class="section-number-3">6.5.</span> [作業]能力相似度&#xa0;&#xa0;&#xa0;<span class="tag"><span class="TNFSH">TNFSH</span></span></h3>
<div class="outline-text-3" id="text-6-5">
<p>
上述計算方式貌似沒什麼問題，但如果今天的問題不是二維地圖中的兩個點，而是：<br />
</p>
<ul class="org-ul">
<li>計算兩個人身材的相似度:特徵值為身高、體重、體脂率<sup><a id="fnr.7" class="footref" href="#fn.7" role="doc-backlink">7</a></sup><br /></li>
<li>計算兩個學生程式設計能力的差異: 特徵值為APCS觀念題分數、APCS實作題分數<sup><a id="fnr.8" class="footref" href="#fn.8" role="doc-backlink">8</a></sup>、一年級程式設計學期分數<br /></li>
</ul>
<p>
我們還能用同樣的方式來計算嗎？<br />
以下是5位學生的程式設計能力資料(特徵值為APCS觀念題分數、APCS實作題分數、一年級程式設計學期分數)，請問那一位學生與你的能力(50, 300, 86)最為接近?<br />
</p>
<ul class="org-ul">
<li>A: 70, 340, 84<br /></li>
<li>B: 60, 310, 89<br /></li>
<li>C: 50, 280, 90<br /></li>
<li>D: 40, 320, 78<br /></li>
<li>E: 91, 310, 99<br /></li>
</ul>
</div>
</div>
</div>
<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" class="footnum" href="#fnr.1" role="doc-backlink">1</a></sup> <div class="footpara" role="doc-footnote"><p class="footpara">
<a href="https://aifreeblog.herokuapp.com/posts/54/data_science_203/">資料的正規化(Normalization)及標準化(Standardization)</a><br />
</p></div></div>

<div class="footdef"><sup><a id="fn.2" class="footnum" href="#fnr.2" role="doc-backlink">2</a></sup> <div class="footpara" role="doc-footnote"><p class="footpara">
<a href="https://cynthiachuang.github.io/What-is-the-Difference-between-Training-Validation-and-Test-Dataset/">訓練集、驗證集、測試集的定義與劃分</a><br />
</p></div></div>

<div class="footdef"><sup><a id="fn.3" class="footnum" href="#fnr.3" role="doc-backlink">3</a></sup> <div class="footpara" role="doc-footnote"><p class="footpara">
<a href="https://cinereplicas.com/products/harry-potter-nimbus-2000-broom-2019-edition">Nimbus 2000</a><br />
</p></div></div>

<div class="footdef"><sup><a id="fn.4" class="footnum" href="#fnr.4" role="doc-backlink">4</a></sup> <div class="footpara" role="doc-footnote"><p class="footpara">
<a href="https://www.pinecone.io/learn/vector-similarity/">Vector Similarity Explained</a><br />
</p></div></div>

<div class="footdef"><sup><a id="fn.5" class="footnum" href="#fnr.5" role="doc-backlink">5</a></sup> <div class="footpara" role="doc-footnote"><p class="footpara">
<a href="http://blog.itpub.net/70027826/viewspace-2970075/">向量資料庫與pgvector </a><br />
</p></div></div>

<div class="footdef"><sup><a id="fn.6" class="footnum" href="#fnr.6" role="doc-backlink">6</a></sup> <div class="footpara" role="doc-footnote"><p class="footpara">
<a href="https://livebook.manning.com/concept/nlp/3d-vector">Natural Language Processing in Action: Understanding, analyzing, and generating text with Python</a><br />
</p></div></div>

<div class="footdef"><sup><a id="fn.7" class="footnum" href="#fnr.7" role="doc-backlink">7</a></sup> <div class="footpara" role="doc-footnote"><p class="footpara">
<a href="https://www.cw.com.tw/index.php/article/5124891?rec=es">體脂肪多少才標準？體脂機的原理是什麼？體脂率對照表一次看</a><br />
</p></div></div>

<div class="footdef"><sup><a id="fn.8" class="footnum" href="#fnr.8" role="doc-backlink">8</a></sup> <div class="footpara" role="doc-footnote"><p class="footpara">
<a href="https://apcs.csie.ntnu.edu.tw/index.php/info/grades/">APCS檢測資訊</a><br />
</p></div></div>


</div>
</div></div>
<div id="postamble" class="status">
<p class="author">Author: Yung-Chin Yen</p>
<p class="date">Created: 2024-07-18 Thu 12:26</p>
</div>
</body>
</html>
